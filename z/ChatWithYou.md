---
tags:
  - tech/ai/project
  - type/resource
  - status/seed
description: ChatWithYouä»¿çœŸç”µè¯äº­é¡¹ç›®å¼€å‘æ–‡æ¡£
created: 2025-01-01T00:00:00
updated: 2025-12-07T21:16:37
---

> [!info] **ä¸Šçº§ç´¢å¼•**
> [[AI MOC]] | [[é¡¹ç›®æ–‡æ¡£ MOC]]

---


# å¼€å‘æ–‡æ¡£

## éœ€æ±‚

å°±åƒä¸€ä¸ªã€Šå“†å•¦Aæ¢¦ã€‹ä¸­çš„é“å…·ã€Œä»¿çœŸç”µè¯äº­ã€ï¼š  
**æ•ˆæœ**ï¼š  
ä½¿ç”¨è€…å¯ä»¥è¾“å…¥ä»»ä½•çœŸå®æˆ–è™šæ„çš„ç”µè¯å·ç ï¼ˆç”šè‡³åŒ…æ‹¬å†å²äººç‰©ã€è™šæ„è§’è‰²ï¼‰ï¼Œç”µè¯äº­ä¼šæ¨¡æ‹Ÿå‡ºä¸å¯¹æ–¹é€šè¯çš„æ•ˆæœã€‚å¯¹æ–¹çš„ååº”å’Œè¯­æ°”ä¼šä¸çœŸäººå®Œå…¨ä¸€è‡´ï¼Œä»¿ä½›çœŸçš„åœ¨å¯¹è¯ã€‚
**åŸç†**ï¼š  
é€šè¿‡æœªæ¥ç§‘æŠ€æ¨¡æ‹Ÿå‡ºå¯¹æ–¹çš„æ€§æ ¼ã€å£°éŸ³å’Œå¯èƒ½çš„å›ç­”ï¼Œå®ç°é€¼çœŸçš„äº’åŠ¨ä½“éªŒã€‚

æˆ‘çš„ ChatWithYouï¼š  
**ç›®æ ‡**ï¼š  
- åˆ¶ä½œä¸€ä¸ªç”¨æ¥å¯¹è¯çš„ ai æ™ºèƒ½ä½“ï¼Œè¿™ä¸ª ai æ™ºèƒ½ä½“åº”è¯¥æ¨¡æ‹Ÿç”šè‡³æˆä¸ºä¸€ä¸ªç‰¹æ®Šå…·ä½“çš„äººï¼ˆegï¼šé²è¿…ã€æç»´åˆšã€‚ã€‚ï¼‰
- å³ç”¨æˆ·èƒ½å¤Ÿå’Œè‡ªå·±æƒ³è¦çš„äººå¯¹è¯ï¼Œå¹¶ä¸” ai æ™ºèƒ½ä½“èƒ½å¤ŸçœŸå®çš„æ¨¡æ‹Ÿæ¨¡ä»¿ä¹‹äººçš„æ€ç»´ã€è¯­æ³•ã€‚
**æ•ˆæœ**ï¼š  
ä½¿ç”¨è€…å¯ä»¥é€‰æ‹©ä»»ä½•çœŸå®æˆ–è™šæ„çš„äººç‰©ï¼ˆç”šè‡³åŒ…æ‹¬å†å²äººç‰©ã€è™šæ„è§’è‰²ï¼‰ï¼Œai æ™ºèƒ½ä½“ä¼šæ¨¡æ‹Ÿå‡ºä¸å¯¹æ–¹é€šè¯çš„æ•ˆæœã€‚å¯¹æ–¹çš„ååº”å’Œè¯­æ°”ä¼šä¸çœŸäººå®Œå…¨ä¸€è‡´ï¼ˆåªæœ‰è¯­è¨€ï¼‰ï¼Œä»¿ä½›çœŸçš„åœ¨å¯¹è¯ã€‚
**åŸç†**ï¼š  
é€šè¿‡å¤§è¯­è¨€æ¨¡å‹æ¨¡æ‹Ÿå‡ºå¯¹æ–¹çš„æ€§æ ¼å’Œå¯èƒ½çš„å›ç­”ï¼Œå®ç°é€¼çœŸçš„äº’åŠ¨ä½“éªŒã€‚  
åº”è¯¥éœ€è¦è¶³å¤Ÿçš„ç›¸å…³äººç‰©çš„æ•°æ®ã€‚

## æŠ€æœ¯æ–¹æ¡ˆ

### æŠ€æœ¯æ ˆé€‰æ‹©ï¼ˆNuxt.js å…¨æ ˆæ–¹æ¡ˆï¼‰

**å…¨æ ˆæ¡†æ¶ï¼ˆ2å¤©ï¼‰**ï¼š
- **Nuxt.js 3** + TypeScript - å…¨æ ˆVueæ¡†æ¶ï¼ŒSSR/SPAæ”¯æŒ
- **Nuxt UI** æˆ– **Element Plus** - ç°ä»£åŒ–UIç»„ä»¶åº“
- **Nitroå¼•æ“** - å†…ç½®æœåŠ¡ç«¯å¼•æ“ï¼Œæ— éœ€å•ç‹¬åç«¯
- **WebSocket/Socket.io** - å®æ—¶å¯¹è¯é€šä¿¡

**æ•°æ®å­˜å‚¨ï¼ˆ1å¤©ï¼‰**ï¼š
- **MongoDB** + **Mongoose** - ç”Ÿäº§çº§æ•°æ®åº“
- **Prisma** (å¯é€‰) - ç°ä»£åŒ–ORMï¼Œç±»å‹å®‰å…¨
- **Redis** (å¯é€‰) - ä¼šè¯ç¼“å­˜å’Œé™æµ

**AIé›†æˆï¼ˆ1å¤©ï¼‰**ï¼š
- **OpenAI GPT-4 API** æˆ– **Claude API** - æˆç†Ÿçš„å¯¹è¯èƒ½åŠ›
- **LangChain.js** (å¯é€‰) - AIåº”ç”¨å¼€å‘æ¡†æ¶
- **è‡ªå®šä¹‰Promptå·¥ç¨‹** - äººç‰©è§’è‰²æ‰®æ¼”

**è®¤è¯ä¸å®‰å…¨ï¼ˆ1å¤©ï¼‰**ï¼š
- **Nuxt Auth** - å†…ç½®è®¤è¯è§£å†³æ–¹æ¡ˆ
- **JWT** - æ— çŠ¶æ€èº«ä»½éªŒè¯
- **Rate Limiting** - APIé™æµä¿æŠ¤

**éƒ¨ç½²ï¼ˆ2å¤©ï¼‰**ï¼š
- **Vercel** - ä¸€é”®éƒ¨ç½²Nuxt.jsåº”ç”¨
- **MongoDB Atlas** - äº‘æ•°æ®åº“
- **Cloudflare** (å¯é€‰) - CDNå’Œå®‰å…¨é˜²æŠ¤

### Nuxt.js ä¼˜åŠ¿åˆ†æ

1. **å¼€å‘æ•ˆç‡æå‡**ï¼š
   - å…¨æ ˆå¼€å‘ï¼Œå‰åç«¯ç»Ÿä¸€
   - å†…ç½®APIè·¯ç”±ï¼Œæ— éœ€å•ç‹¬åç«¯æœåŠ¡
   - è‡ªåŠ¨ä»£ç åˆ†å‰²å’Œä¼˜åŒ–
   - çƒ­é‡è½½å’Œå¼€å‘è€…ä½“éªŒä¼˜ç§€

2. **SEOå’Œæ€§èƒ½**ï¼š
   - æœåŠ¡ç«¯æ¸²æŸ“(SSR)æ”¯æŒ
   - è‡ªåŠ¨ç”Ÿæˆsitemapå’Œmetaæ ‡ç­¾
   - å›¾ç‰‡ä¼˜åŒ–å’Œæ‡’åŠ è½½
   - æ¸è¿›å¼Webåº”ç”¨(PWA)æ”¯æŒ

3. **éƒ¨ç½²ç®€å•**ï¼š
   - Vercelä¸€é”®éƒ¨ç½²
   - è‡ªåŠ¨CI/CDé›†æˆ
   - è¾¹ç¼˜å‡½æ•°æ”¯æŒ
   - å…¨çƒCDNåˆ†å‘

### ç³»ç»Ÿæ¶æ„è®¾è®¡ï¼ˆNuxt.js æ¶æ„ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Nuxt.js åº”ç”¨                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å®¢æˆ·ç«¯ (SPA/SSR)                        â”‚
â”‚  â”œâ”€â”€ pages/                             â”‚
â”‚  â”‚   â”œâ”€â”€ index.vue (äººç‰©é€‰æ‹©é¡µ)          â”‚
â”‚  â”‚   â”œâ”€â”€ chat/[id].vue (å¯¹è¯é¡µé¢)        â”‚
â”‚  â”‚   â””â”€â”€ history.vue (å†å²è®°å½•)          â”‚
â”‚  â”œâ”€â”€ components/                        â”‚
â”‚  â”‚   â”œâ”€â”€ CharacterSelector.vue          â”‚
â”‚  â”‚   â”œâ”€â”€ ChatInterface.vue              â”‚
â”‚  â”‚   â””â”€â”€ MessageBubble.vue              â”‚
â”‚  â””â”€â”€ composables/                       â”‚
â”‚      â”œâ”€â”€ useChat.ts                     â”‚
â”‚      â”œâ”€â”€ useCharacters.ts               â”‚
â”‚      â””â”€â”€ useWebSocket.ts                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœåŠ¡ç«¯ (Nitro API)                      â”‚
â”‚  â”œâ”€â”€ server/api/                        â”‚
â”‚  â”‚   â”œâ”€â”€ characters/                    â”‚
â”‚  â”‚   â”œâ”€â”€ conversations/                 â”‚
â”‚  â”‚   â””â”€â”€ ai/                            â”‚
â”‚  â”œâ”€â”€ server/middleware/                 â”‚
â”‚  â”‚   â”œâ”€â”€ auth.ts                        â”‚
â”‚  â”‚   â””â”€â”€ rateLimit.ts                   â”‚
â”‚  â””â”€â”€ server/plugins/                    â”‚
â”‚      â”œâ”€â”€ mongodb.ts                     â”‚
â”‚      â””â”€â”€ socketio.ts                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”œâ”€â”€ å¤–éƒ¨æœåŠ¡
â”‚   â”œâ”€â”€ MongoDB Atlas (æ•°æ®å­˜å‚¨)
â”‚   â”œâ”€â”€ OpenAI API (AIå¯¹è¯)
â”‚   â””â”€â”€ Redis (å¯é€‰ç¼“å­˜)
```

### æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

1. **äººç‰©ç®¡ç†ç³»ç»Ÿ**
   - é¢„è®¾ç»å…¸äººç‰©ï¼ˆé²è¿…ã€å­”å­ã€çˆ±å› æ–¯å¦ç­‰ï¼‰
   - æ¯ä¸ªäººç‰©åŒ…å«ï¼šåŸºæœ¬ä¿¡æ¯ã€æ€§æ ¼ç‰¹ç‚¹ã€è¯­è¨€é£æ ¼ã€ç»å…¸è¯­å½•
   - æ”¯æŒè‡ªå®šä¹‰æ·»åŠ äººç‰©

2. **æ™ºèƒ½å¯¹è¯å¼•æ“**
   - åŸºäºé€‰å®šäººç‰©æ„å»ºä¸“é—¨çš„ç³»ç»Ÿæç¤ºè¯
   - å®æ—¶è°ƒç”¨AI APIç”Ÿæˆå›å¤
   - ä¿æŒå¯¹è¯ä¸Šä¸‹æ–‡è¿è´¯æ€§

3. **å¯¹è¯ç•Œé¢**
   - ç±»ä¼¼å¾®ä¿¡çš„èŠå¤©ç•Œé¢
   - æ˜¾ç¤ºé€‰å®šäººç‰©å¤´åƒå’Œä¿¡æ¯
   - æ”¯æŒæ–‡å­—è¾“å…¥å’Œå†å²è®°å½•æŸ¥çœ‹

### 7å¤©å¼€å‘è®¡åˆ’ï¼ˆNuxt.js ç‰ˆæœ¬ï¼‰

**Day 1: é¡¹ç›®åˆå§‹åŒ–å’ŒåŸºç¡€è®¾ç½®**
- åˆ›å»ºNuxt.js 3é¡¹ç›® (`npx nuxi@latest init chatwithyou`)
- é…ç½®TypeScriptã€TailwindCSSã€UIåº“
- è®¾ç½®MongoDBè¿æ¥å’ŒPrisma ORM
- æ­å»ºåŸºæœ¬é¡µé¢ç»“æ„å’Œè·¯ç”±

**Day 2: è§’è‰²ç®¡ç†å’Œæ•°æ®å»ºæ¨¡**
- è®¾è®¡æ•°æ®åº“Schema (ç”¨æˆ·ã€è§’è‰²ã€å¯¹è¯)
- å®ç°è§’è‰²ç®¡ç†API (`/api/characters/`)
- åˆ›å»ºè§’è‰²é€‰æ‹©é¡µé¢å’Œç»„ä»¶
- æ·»åŠ è§’è‰²æ•°æ®ç§å­æ–‡ä»¶

**Day 3: å¯¹è¯æ ¸å¿ƒåŠŸèƒ½**
- å®ç°å¯¹è¯API (`/api/conversations/`)
- é›†æˆOpenAI APIæœåŠ¡
- åˆ›å»ºèŠå¤©ç•Œé¢ç»„ä»¶
- å®ç°æ¶ˆæ¯å‘é€å’Œæ¥æ”¶é€»è¾‘

**Day 4: å®æ—¶é€šä¿¡å’Œç”¨æˆ·ä½“éªŒ**
- é›†æˆSocket.ioå®ç°å®æ—¶å¯¹è¯
- ä¼˜åŒ–èŠå¤©ç•Œé¢äº¤äº’
- æ·»åŠ æ¶ˆæ¯å†å²è®°å½•åŠŸèƒ½
- å®ç°å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†

**Day 5: AIè§’è‰²æ‰®æ¼”ä¼˜åŒ–**
- è®¾è®¡æ™ºèƒ½Promptç”Ÿæˆç³»ç»Ÿ
- å®ç°è§’è‰²ç‰¹å¾æå–å’Œåº”ç”¨
- æµ‹è¯•ä¸åŒäººç‰©çš„å¯¹è¯æ•ˆæœ
- ä¼˜åŒ–AIå›å¤è´¨é‡å’Œä¸€è‡´æ€§

**Day 6: ç”¨æˆ·è®¤è¯å’Œå®Œå–„åŠŸèƒ½**
- é›†æˆNuxt Authç”¨æˆ·è®¤è¯
- æ·»åŠ ç”¨æˆ·åå¥½è®¾ç½®
- å®ç°å¯¹è¯å†å²ç®¡ç†
- é”™è¯¯å¤„ç†å’Œç”¨æˆ·ä½“éªŒä¼˜åŒ–

**Day 7: æµ‹è¯•ã€ä¼˜åŒ–å’Œéƒ¨ç½²**
- å…¨é¢åŠŸèƒ½æµ‹è¯•å’Œbugä¿®å¤
- æ€§èƒ½ä¼˜åŒ–å’ŒSEOè®¾ç½®
- éƒ¨ç½²åˆ°Vercelå’ŒMongoDB Atlas
- åŸŸåé…ç½®å’Œä¸Šçº¿å‡†å¤‡

### å…³é”®æŠ€æœ¯å®ç°ï¼ˆNuxt.js ç‰ˆæœ¬ï¼‰

**1. Nuxt.js API è·¯ç”±å®ç°**

```typescript
// server/api/chat/send.post.ts
export default defineEventHandler(async (event) => {
  const { message, characterId, conversationId } = await readBody(event)
  
  // éªŒè¯ç”¨æˆ·èº«ä»½
  const user = await getUserFromToken(event)
  if (!user) {
    throw createError({
      statusCode: 401,
      statusMessage: 'Unauthorized'
    })
  }

  // è·å–å¯¹è¯å’Œè§’è‰²ä¿¡æ¯
  const conversation = await getConversation(conversationId)
  const character = await getCharacter(characterId)
  
  // æ„å»ºAIæç¤ºè¯
  const prompt = buildCharacterPrompt(character, conversation.history)
  
  // è°ƒç”¨OpenAI API
  const aiResponse = await generateAIResponse(prompt, message)
  
  // ä¿å­˜æ¶ˆæ¯
  await saveMessage(conversationId, {
    type: 'user',
    content: message,
    timestamp: new Date()
  })
  
  await saveMessage(conversationId, {
    type: 'ai',
    content: aiResponse,
    timestamp: new Date()
  })
  
  return { response: aiResponse }
})
```

**2. Vue Composables å®ç°**

```typescript
// composables/useChat.ts
export const useChat = (characterId: string) => {
  const messages = ref<Message[]>([])
  const isLoading = ref(false)
  const conversationId = ref<string>()

  const sendMessage = async (content: string) => {
    if (!content.trim()) return

    // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°ç•Œé¢
    messages.value.push({
      type: 'user',
      content,
      timestamp: new Date()
    })

    isLoading.value = true

    try {
      // å‘é€åˆ°API
      const { data } = await $fetch('/api/chat/send', {
        method: 'POST',
        body: {
          message: content,
          characterId: characterId,
          conversationId: conversationId.value
        }
      })

      // æ·»åŠ AIå›å¤åˆ°ç•Œé¢
      messages.value.push({
        type: 'ai',
        content: data.response,
        timestamp: new Date()
      })
    } catch (error) {
      console.error('å‘é€æ¶ˆæ¯å¤±è´¥:', error)
    } finally {
      isLoading.value = false
    }
  }

  return {
    messages: readonly(messages),
    isLoading: readonly(isLoading),
    sendMessage
  }
}
```

**3. Socket.io é›†æˆ**

```typescript
// server/plugins/socketio.ts
import { Server } from 'socket.io'
import type { NitroApp } from 'nitropack'

export default async (nitroApp: NitroApp) => {
  const io = new Server(nitroApp.hooks.render.route, {
    cors: {
      origin: "*",
      methods: ["GET", "POST"]
    }
  })

  io.on('connection', (socket) => {
    console.log('ç”¨æˆ·è¿æ¥:', socket.id)

    socket.on('join-conversation', (conversationId) => {
      socket.join(conversationId)
    })

    socket.on('send-message', async (data) => {
      const { message, characterId, conversationId } = data
      
      // å¤„ç†æ¶ˆæ¯é€»è¾‘
      const aiResponse = await processMessage(message, characterId, conversationId)
      
      // å¹¿æ’­å›å¤ç»™å¯¹è¯æˆ¿é—´
      io.to(conversationId).emit('ai-response', {
        message: aiResponse,
        timestamp: new Date()
      })
    })

    socket.on('disconnect', () => {
      console.log('ç”¨æˆ·æ–­å¼€è¿æ¥:', socket.id)
    })
  })
}
```

**4. æ•°æ®åº“Schema (Prisma)**

```prisma
// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id            String         @id @default(auto()) @map("_id") @db.ObjectId
  email         String         @unique
  name          String
  avatar        String?
  conversations Conversation[]
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
}

model Character {
  id            String         @id @default(auto()) @map("_id") @db.ObjectId
  name          String
  avatar        String
  background    String
  personality   String[]
  speakingStyle String
  quotes        String[]
  category      String
  isActive      Boolean        @default(true)
  conversations Conversation[]
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
}

model Conversation {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  user        User      @relation(fields: [userId], references: [id])
  userId      String    @db.ObjectId
  character   Character @relation(fields: [characterId], references: [id])
  characterId String    @db.ObjectId
  messages    Message[]
  title       String?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Message {
  id             String       @id @default(auto()) @map("_id") @db.ObjectId
  conversation   Conversation @relation(fields: [conversationId], references: [id])
  conversationId String       @db.ObjectId
  type           String       // 'user' | 'ai'
  content        String
  timestamp      DateTime     @default(now())
}
```

### é¡¹ç›®ç»“æ„ï¼ˆNuxt.js ç‰ˆæœ¬ï¼‰

```
ChatWithYou-Nuxt/
â”œâ”€â”€ pages/                          # é¡µé¢è·¯ç”±
â”‚   â”œâ”€â”€ index.vue                   # é¦–é¡µ - è§’è‰²é€‰æ‹©
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â””â”€â”€ [id].vue                # å¯¹è¯é¡µé¢
â”‚   â”œâ”€â”€ history.vue                 # å¯¹è¯å†å²
â”‚   â””â”€â”€ profile.vue                 # ç”¨æˆ·è®¾ç½®
â”‚
â”œâ”€â”€ components/                     # Vueç»„ä»¶
â”‚   â”œâ”€â”€ Character/
â”‚   â”‚   â”œâ”€â”€ CharacterCard.vue       # è§’è‰²å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ CharacterGrid.vue       # è§’è‰²ç½‘æ ¼
â”‚   â”‚   â””â”€â”€ CharacterDetail.vue     # è§’è‰²è¯¦æƒ…
â”‚   â”œâ”€â”€ Chat/
â”‚   â”‚   â”œâ”€â”€ ChatInterface.vue       # èŠå¤©ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ MessageBubble.vue       # æ¶ˆæ¯æ°”æ³¡
â”‚   â”‚   â”œâ”€â”€ InputArea.vue           # è¾“å…¥åŒºåŸŸ
â”‚   â”‚   â””â”€â”€ TypingIndicator.vue     # è¾“å…¥çŠ¶æ€æŒ‡ç¤º
â”‚   â””â”€â”€ UI/
â”‚       â”œâ”€â”€ AppHeader.vue           # åº”ç”¨å¤´éƒ¨
â”‚       â”œâ”€â”€ AppSidebar.vue          # ä¾§è¾¹æ 
â”‚       â””â”€â”€ LoadingSpinner.vue      # åŠ è½½åŠ¨ç”»
â”‚
â”œâ”€â”€ composables/                    # å¯ç»„åˆå‡½æ•°
â”‚   â”œâ”€â”€ useAuth.ts                  # è®¤è¯çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ useChat.ts                  # èŠå¤©åŠŸèƒ½
â”‚   â”œâ”€â”€ useCharacters.ts            # è§’è‰²ç®¡ç†
â”‚   â”œâ”€â”€ useWebSocket.ts             # WebSocketè¿æ¥
â”‚   â””â”€â”€ useLocalStorage.ts          # æœ¬åœ°å­˜å‚¨
â”‚
â”œâ”€â”€ server/                         # æœåŠ¡ç«¯ä»£ç 
â”‚   â”œâ”€â”€ api/                        # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”œâ”€â”€ login.post.ts
â”‚   â”‚   â”‚   â””â”€â”€ register.post.ts
â”‚   â”‚   â”œâ”€â”€ characters/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.get.ts        # è·å–è§’è‰²åˆ—è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ [id].get.ts         # è·å–å•ä¸ªè§’è‰²
â”‚   â”‚   â”‚   â””â”€â”€ search.get.ts       # æœç´¢è§’è‰²
â”‚   â”‚   â”œâ”€â”€ conversations/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.get.ts        # è·å–å¯¹è¯åˆ—è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ [id].get.ts         # è·å–å¯¹è¯è¯¦æƒ…
â”‚   â”‚   â”‚   â””â”€â”€ create.post.ts      # åˆ›å»ºæ–°å¯¹è¯
â”‚   â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”‚   â””â”€â”€ send.post.ts        # å‘é€æ¶ˆæ¯
â”‚   â”‚   â””â”€â”€ ai/
â”‚   â”‚       â””â”€â”€ generate.post.ts    # AIç”Ÿæˆå›å¤
â”‚   â”œâ”€â”€ middleware/                 # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ auth.ts                 # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ rateLimit.ts            # é™æµä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ cors.ts                 # CORSä¸­é—´ä»¶
â”‚   â”œâ”€â”€ plugins/                    # æœåŠ¡ç«¯æ’ä»¶
â”‚   â”‚   â”œâ”€â”€ mongodb.ts              # MongoDBè¿æ¥
â”‚   â”‚   â””â”€â”€ socketio.ts             # Socket.ioé…ç½®
â”‚   â””â”€â”€ utils/                      # æœåŠ¡ç«¯å·¥å…·
â”‚       â”œâ”€â”€ ai.ts                   # AIæœåŠ¡å°è£…
â”‚       â”œâ”€â”€ db.ts                   # æ•°æ®åº“æ“ä½œ
â”‚       â””â”€â”€ auth.ts                 # è®¤è¯å·¥å…·
â”‚
â”œâ”€â”€ stores/                         # PiniaçŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ auth.ts                     # ç”¨æˆ·è®¤è¯çŠ¶æ€
â”‚   â”œâ”€â”€ chat.ts                     # èŠå¤©çŠ¶æ€
â”‚   â””â”€â”€ ui.ts                       # UIçŠ¶æ€
â”‚
â”œâ”€â”€ types/                          # TypeScriptç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ api.ts                      # APIç±»å‹
â”‚   â”œâ”€â”€ character.ts                # è§’è‰²ç±»å‹
â”‚   â”œâ”€â”€ conversation.ts             # å¯¹è¯ç±»å‹
â”‚   â””â”€â”€ user.ts                     # ç”¨æˆ·ç±»å‹
â”‚
â”œâ”€â”€ contracts/                      # APIå¥‘çº¦å®šä¹‰ï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ character.contract.ts       # è§’è‰²APIå¥‘çº¦
â”‚   â”œâ”€â”€ conversation.contract.ts    # å¯¹è¯APIå¥‘çº¦
â”‚   â””â”€â”€ auth.contract.ts            # è®¤è¯APIå¥‘çº¦
â”‚
â”œâ”€â”€ schemas/                        # æ•°æ®éªŒè¯Schema
â”‚   â”œâ”€â”€ character.schema.ts         # è§’è‰²æ•°æ®éªŒè¯
â”‚   â”œâ”€â”€ message.schema.ts           # æ¶ˆæ¯æ•°æ®éªŒè¯
â”‚   â””â”€â”€ user.schema.ts              # ç”¨æˆ·æ•°æ®éªŒè¯
â”‚
â”œâ”€â”€ prisma/                         # Prisma ORM
â”‚   â”œâ”€â”€ schema.prisma               # æ•°æ®åº“æ¨¡å¼
â”‚   â””â”€â”€ seed.ts                     # æ•°æ®ç§å­
â”‚
â”œâ”€â”€ public/                         # é™æ€èµ„æº
â”‚   â”œâ”€â”€ avatars/                    # è§’è‰²å¤´åƒ
â”‚   â””â”€â”€ icons/                      # å›¾æ ‡èµ„æº
â”‚
â”œâ”€â”€ nuxt.config.ts                  # Nuxté…ç½®
â”œâ”€â”€ tailwind.config.js              # TailwindCSSé…ç½®
â”œâ”€â”€ package.json                    # é¡¹ç›®ä¾èµ–
â””â”€â”€ README.md                       # é¡¹ç›®è¯´æ˜
```

### é¢„è®¾äººç‰©æ•°æ®ç»“æ„

```json
{
  "characters": [
    {
      "id": "luxun",
      "name": "é²è¿…",
      "avatar": "/avatars/luxun.jpg",
      "background": "ä¸­å›½ç°ä»£æ–‡å­¦å¥ åŸºäººï¼Œæ€æƒ³å®¶ï¼Œé©å‘½å®¶",
      "personality": "çŠ€åˆ©ã€æ·±åˆ»ã€è®½åˆºã€å¿§å›½å¿§æ°‘",
      "speaking_style": "æ–‡è¨€ç™½è¯ç»“åˆï¼Œå–„ç”¨æ¯”å–»å’Œè®½åˆº",
      "quotes": [
        "æ¨ªçœ‰å†·å¯¹åƒå¤«æŒ‡ï¼Œä¿¯é¦–ç”˜ä¸ºå­ºå­ç‰›",
        "ä¸åœ¨æ²‰é»˜ä¸­çˆ†å‘ï¼Œå°±åœ¨æ²‰é»˜ä¸­ç­äº¡"
      ],
      "knowledge_areas": ["æ–‡å­¦", "ç¤¾ä¼šæ‰¹åˆ¤", "äººæ€§æ€è€ƒ"]
    }
  ]
}
```

### æˆæœ¬é¢„ä¼°ï¼ˆNuxt.js ç‰ˆæœ¬ï¼‰

- **å¼€å‘æˆæœ¬**ï¼š7å¤©ä¸ªäººå¼€å‘
- **APIæˆæœ¬**ï¼šOpenAI APIçº¦$10-20/æœˆï¼ˆå–å†³äºä½¿ç”¨é‡ï¼‰
- **æ•°æ®åº“æˆæœ¬**ï¼šMongoDB Atlaså…è´¹å¥—é¤512MB
- **éƒ¨ç½²æˆæœ¬**ï¼šVercelå…è´¹å¥—é¤ï¼ˆä¸ªäººé¡¹ç›®è¶³å¤Ÿï¼‰
- **åŸŸåæˆæœ¬**ï¼š$10-15/å¹´ï¼ˆå¯é€‰ï¼‰
- **æ€»åˆæœŸæˆæœ¬**ï¼š< $50/å¹´

### Nuxt.js ç‰¹æœ‰ä¼˜åŠ¿

1. **å¼€å‘ä½“éªŒ**ï¼š
   - é›¶é…ç½®TypeScriptæ”¯æŒ
   - è‡ªåŠ¨å¯¼å…¥ç»„ä»¶å’Œcomposables
   - å†…ç½®å¼€å‘å·¥å…·å’Œè°ƒè¯•æ”¯æŒ
   - çƒ­é‡è½½å’Œå¿«é€Ÿåˆ·æ–°

2. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - è‡ªåŠ¨ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
   - å›¾ç‰‡ä¼˜åŒ–å’ŒWebPæ”¯æŒ
   - CSSä»£ç åˆ†å‰²å’Œå‹ç¼©
   - é¢„æ¸²æŸ“å’Œé™æ€ç”Ÿæˆ

3. **SEOå‹å¥½**ï¼š
   - æœåŠ¡ç«¯æ¸²æŸ“(SSR)æ”¯æŒ
   - è‡ªåŠ¨ç”Ÿæˆmetaæ ‡ç­¾
   - ç»“æ„åŒ–æ•°æ®æ”¯æŒ
   - sitemapè‡ªåŠ¨ç”Ÿæˆ

4. **å…¨æ ˆèƒ½åŠ›**ï¼š
   - å†…ç½®APIè·¯ç”±ç³»ç»Ÿ
   - æœåŠ¡ç«¯ä¸­é—´ä»¶æ”¯æŒ
   - æ•°æ®åº“è¿æ¥å’ŒORMé›†æˆ
   - è®¤è¯ç³»ç»Ÿé›†æˆ

5. **ç±»å‹å®‰å…¨ç»Ÿä¸€**ï¼š
   - å‰åç«¯å…±äº«TypeScriptç±»å‹
   - è‡ªåŠ¨ç±»å‹æ¨æ–­å’ŒéªŒè¯
   - ç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥
   - æ— éœ€é¢å¤–çš„Contractå±‚ï¼ˆå¯é€‰ï¼‰

### ç±»å‹å®šä¹‰ç»Ÿä¸€æ–¹æ¡ˆ

åœ¨Nuxt.jsä¸­ï¼Œå‰åç«¯å¯ä»¥å®Œå…¨å…±äº«ç±»å‹å®šä¹‰ï¼Œæ— éœ€ä¼ ç»Ÿçš„Contractså±‚ï¼Œä½†æˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ›´ä¼˜é›…çš„æ–¹æ¡ˆï¼š

**1. å…±äº«ç±»å‹å®šä¹‰**

```typescript
// types/character.ts - å‰åç«¯å…±äº«
export interface Character {
  id: string
  name: string
  avatar: string
  background: string
  personality: string[]
  speakingStyle: string
  quotes: string[]
  category: CharacterCategory
  isActive: boolean
  createdAt: Date
  updatedAt: Date
}

export interface CreateCharacterRequest {
  name: string
  background: string
  personality: string[]
  speakingStyle: string
  quotes: string[]
  category: CharacterCategory
}

export interface UpdateCharacterRequest extends Partial<CreateCharacterRequest> {
  id: string
}

export enum CharacterCategory {
  HISTORICAL = 'historical',
  FICTIONAL = 'fictional',
  CELEBRITY = 'celebrity',
  CUSTOM = 'custom'
}
```

**2. APIå“åº”ç±»å‹**

```typescript
// types/api.ts - ç»Ÿä¸€APIå“åº”æ ¼å¼
export interface ApiResponse<T = any> {
  success: boolean
  data?: T
  error?: string
  message?: string
}

export interface PaginatedResponse<T> extends ApiResponse<T[]> {
  pagination: {
    page: number
    limit: number
    total: number
    totalPages: number
  }
}

// APIç«¯ç‚¹ç±»å‹å®šä¹‰
export interface CharacterEndpoints {
  'GET /api/characters': {
    query?: {
      category?: CharacterCategory
      search?: string
      page?: number
      limit?: number
    }
    response: PaginatedResponse<Character>
  }
  
  'GET /api/characters/[id]': {
    params: { id: string }
    response: ApiResponse<Character>
  }
  
  'POST /api/characters': {
    body: CreateCharacterRequest
    response: ApiResponse<Character>
  }
  
  'PUT /api/characters/[id]': {
    params: { id: string }
    body: UpdateCharacterRequest
    response: ApiResponse<Character>
  }
}
```

**3. æ•°æ®éªŒè¯Schemaï¼ˆä½¿ç”¨Zodï¼‰**

```typescript
// schemas/character.schema.ts
import { z } from 'zod'

export const CharacterCategorySchema = z.enum([
  'historical', 'fictional', 'celebrity', 'custom'
])

export const CreateCharacterSchema = z.object({
  name: z.string().min(1).max(100),
  background: z.string().min(10).max(1000),
  personality: z.array(z.string()).min(1).max(10),
  speakingStyle: z.string().min(10).max(500),
  quotes: z.array(z.string()).max(20),
  category: CharacterCategorySchema
})

export const UpdateCharacterSchema = CreateCharacterSchema.partial().extend({
  id: z.string()
})

// è‡ªåŠ¨æ¨æ–­ç±»å‹
export type CreateCharacterRequest = z.infer<typeof CreateCharacterSchema>
export type UpdateCharacterRequest = z.infer<typeof UpdateCharacterSchema>
```

**4. æœåŠ¡ç«¯APIå®ç°**

```typescript
// server/api/characters/index.get.ts
export default defineEventHandler(async (event): Promise<PaginatedResponse<Character>> => {
  const query = getQuery(event)
  
  // ç±»å‹éªŒè¯
  const { category, search, page = 1, limit = 10 } = query
  
  try {
    const characters = await characterService.findMany({
      category: category as CharacterCategory,
      search: search as string,
      page: Number(page),
      limit: Number(limit)
    })
    
    return {
      success: true,
      data: characters.items,
      pagination: characters.pagination
    }
  } catch (error) {
    throw createError({
      statusCode: 500,
      statusMessage: 'Failed to fetch characters'
    })
  }
})
```

**5. å®¢æˆ·ç«¯APIè°ƒç”¨**

```typescript
// composables/useCharacters.ts
export const useCharacters = () => {
  // ç±»å‹å®‰å…¨çš„APIè°ƒç”¨
  const fetchCharacters = async (params?: {
    category?: CharacterCategory
    search?: string
    page?: number
    limit?: number
  }): Promise<PaginatedResponse<Character>> => {
    return await $fetch('/api/characters', {
      query: params
    })
  }
  
  const fetchCharacter = async (id: string): Promise<ApiResponse<Character>> => {
    return await $fetch(`/api/characters/${id}`)
  }
  
  const createCharacter = async (
    data: CreateCharacterRequest
  ): Promise<ApiResponse<Character>> => {
    return await $fetch('/api/characters', {
      method: 'POST',
      body: data
    })
  }
  
  return {
    fetchCharacters,
    fetchCharacter,
    createCharacter
  }
}
```

**6. é«˜çº§ç±»å‹å®‰å…¨APIï¼ˆå¯é€‰ - tRPCé£æ ¼ï¼‰**

```typescript
// contracts/api.contract.ts - å¯é€‰çš„å¥‘çº¦å±‚
import type { CharacterEndpoints } from '~/types/api'

export type ApiContract = CharacterEndpoints & ConversationEndpoints & AuthEndpoints

// ç±»å‹å®‰å…¨çš„fetch wrapper
export const apiClient = {
  get: <T extends keyof ApiContract>(
    endpoint: T,
    ...args: ApiContract[T] extends { query?: infer Q } ? [query?: Q] : []
  ): Promise<ApiContract[T]['response']> => {
    return $fetch(endpoint, { query: args[0] })
  },
  
  post: <T extends keyof ApiContract>(
    endpoint: T,
    ...args: ApiContract[T] extends { body: infer B } ? [body: B] : []
  ): Promise<ApiContract[T]['response']> => {
    return $fetch(endpoint, { method: 'POST', body: args[0] })
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const characters = await apiClient.get('/api/characters', { 
  category: 'historical',
  page: 1 
}) // è‡ªåŠ¨æ¨æ–­è¿”å›ç±»å‹
```

**7. æœåŠ¡ç«¯éªŒè¯ä¸­é—´ä»¶**

```typescript
// server/middleware/validation.ts
import { z } from 'zod'

export const validateBody = <T extends z.ZodSchema>(schema: T) => {
  return defineEventHandler(async (event) => {
    if (event.node.req.method === 'POST' || event.node.req.method === 'PUT') {
      const body = await readBody(event)
      
      try {
        const validatedData = schema.parse(body)
        event.context.validatedBody = validatedData
      } catch (error) {
        throw createError({
          statusCode: 400,
          statusMessage: 'Validation failed',
          data: error
        })
      }
    }
  })
}

// ä½¿ç”¨ç¤ºä¾‹
// server/api/characters/index.post.ts
export default defineEventHandler({
  onRequest: [validateBody(CreateCharacterSchema)],
  handler: async (event) => {
    const data = event.context.validatedBody as CreateCharacterRequest
    // data å·²ç»æ˜¯éªŒè¯è¿‡çš„ç±»å‹å®‰å…¨æ•°æ®
    const character = await characterService.create(data)
    return { success: true, data: character }
  }
})
```

### é£é™©æ§åˆ¶ï¼ˆNuxt.js ç‰ˆæœ¬ï¼‰

1. **AI APIé™æµ**ï¼š
   - ä½¿ç”¨Nuxt Rate Limitæ¨¡å—
   - å®ç°è¯·æ±‚é˜Ÿåˆ—å’Œé‡è¯•æœºåˆ¶
   - æ·»åŠ ç”¨æˆ·çº§åˆ«é™æµ

2. **è§’è‰²ä¸€è‡´æ€§**ï¼š
   - å»ºç«‹å®Œå–„çš„è§’è‰²æµ‹è¯•ç”¨ä¾‹
   - å®ç°A/Bæµ‹è¯•æ¯”è¾ƒä¸åŒpromptæ•ˆæœ
   - ç”¨æˆ·åé¦ˆæ”¶é›†å’Œä¼˜åŒ–æœºåˆ¶

3. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - Nuxtå†…ç½®å›¾ç‰‡ä¼˜åŒ–
   - ç»„ä»¶æ‡’åŠ è½½å’Œé¢„å–
   - CDNç¼“å­˜ç­–ç•¥
   - æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–

4. **æ‰©å±•æ€§è®¾è®¡**ï¼š
   - æ¨¡å—åŒ–ç»„ä»¶è®¾è®¡
   - æ’ä»¶ç³»ç»Ÿæ”¯æŒ
   - å¤šè¯­è¨€å›½é™…åŒ–å‡†å¤‡
   - ç§»åŠ¨ç«¯é€‚é…

5. **å®‰å…¨é˜²æŠ¤**ï¼š
   - CSRFä¿æŠ¤
   - XSSé˜²æŠ¤
   - SQLæ³¨å…¥é˜²æŠ¤
   - ç”¨æˆ·è¾“å…¥éªŒè¯å’Œæ¸…ç†

### å¿«é€Ÿå¼€å§‹å‘½ä»¤

```bash
# åˆ›å»ºæ–°é¡¹ç›®
npx nuxi@latest init chatwithyou
cd chatwithyou

# å®‰è£…ä¾èµ–
npm install

# å®‰è£…é¢å¤–ä¾èµ–
npm install @prisma/client prisma socket.io openai zod

# å®‰è£…UIåº“
npm install @nuxt/ui @headlessui/vue @heroicons/vue

# å®‰è£…è®¤è¯
npm install @sidebase/nuxt-auth

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

### ç±»å‹å®‰å…¨æœ€ä½³å®è·µæ€»ç»“

**ä¼˜åŠ¿ï¼š**
1. **æ— éœ€Contractså±‚**ï¼šNuxt.jså¤©ç„¶æ”¯æŒå‰åç«¯ç±»å‹å…±äº«
2. **ç¼–è¯‘æ—¶æ£€æŸ¥**ï¼šTypeScriptåœ¨ç¼–è¯‘æ—¶å°±èƒ½å‘ç°ç±»å‹é”™è¯¯
3. **è‡ªåŠ¨å®Œæˆ**ï¼šIDEæä¾›å®Œæ•´çš„ç±»å‹æç¤ºå’Œè‡ªåŠ¨å®Œæˆ
4. **é‡æ„å®‰å…¨**ï¼šä¿®æ”¹ç±»å‹å®šä¹‰ä¼šè‡ªåŠ¨æ£€æŸ¥æ‰€æœ‰ä½¿ç”¨åœ°æ–¹

**æ¨èæ–¹æ¡ˆï¼š**
- **åŸºç¡€é¡¹ç›®**ï¼šç›´æ¥å…±äº«typesç›®å½•ï¼Œæ— éœ€é¢å¤–contracts
- **å¤§å‹é¡¹ç›®**ï¼šå¯ä»¥æ·»åŠ contractså±‚æä¾›æ›´ä¸¥æ ¼çš„APIå¥‘çº¦
- **å›¢é˜Ÿåä½œ**ï¼šä½¿ç”¨Zodè¿›è¡Œè¿è¡Œæ—¶éªŒè¯ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§

**æ–‡ä»¶ç»„ç»‡ï¼š**

```
types/          # åŸºç¡€ç±»å‹å®šä¹‰ï¼ˆå¿…éœ€ï¼‰
schemas/        # æ•°æ®éªŒè¯ï¼ˆæ¨èï¼‰
contracts/      # APIå¥‘çº¦ï¼ˆå¯é€‰ï¼Œå¤§å‹é¡¹ç›®ï¼‰
```

è¿™ä¸ªæŠ€æœ¯æ–¹æ¡ˆå……åˆ†è€ƒè™‘äº†7å¤©çš„å¼€å‘æ—¶é—´é™åˆ¶ï¼Œé€‰æ‹©äº†æˆç†Ÿç¨³å®šçš„æŠ€æœ¯æ ˆï¼Œå¹¶ä¸”æä¾›äº†æ¸…æ™°çš„å¼€å‘è·¯å¾„å’Œå®ç°ç»†èŠ‚ã€‚

**ä½¿ç”¨Nuxt.jsçš„æ ¸å¿ƒä¼˜åŠ¿ï¼š**
1. **å…¨æ ˆç»Ÿä¸€**ï¼šå‰åç«¯ä½¿ç”¨åŒä¸€å¥—æŠ€æœ¯æ ˆï¼Œå‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢
2. **å¼€å‘æ•ˆç‡**ï¼šå†…ç½®çš„APIè·¯ç”±ã€è‡ªåŠ¨å¯¼å…¥ã€çƒ­é‡è½½ç­‰ç‰¹æ€§å¤§å¹…æå‡å¼€å‘é€Ÿåº¦
3. **éƒ¨ç½²ç®€å•**ï¼šä¸€é”®éƒ¨ç½²åˆ°Vercelï¼Œæ— éœ€å¤æ‚çš„æœåŠ¡å™¨é…ç½®
4. **SEOå‹å¥½**ï¼šå†…ç½®SSRæ”¯æŒï¼Œæœ‰åˆ©äºæœç´¢å¼•æ“ä¼˜åŒ–
5. **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„TypeScriptæ”¯æŒï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯
6. **ç°ä»£åŒ–**ï¼šä½¿ç”¨æœ€æ–°çš„Vue 3 Composition APIå’Œç°ä»£å‰ç«¯å·¥å…·é“¾

## DDDæ¶æ„è®¾è®¡

### æ¶æ„é€‰æ‹©è¯´æ˜

**é¢å‘å¯¹è±¡ â‰  å¿…é¡»ä½¿ç”¨DDD**

å¾ˆå¤šå¼€å‘è€…è®¤ä¸ºé¢å‘å¯¹è±¡å°±å¿…é¡»ä½¿ç”¨DDDï¼Œè¿™æ˜¯ä¸€ä¸ªè¯¯åŒºï¼š

#### ğŸ¯ **ä½•æ—¶é€‰æ‹©DDD**

- **å¤æ‚ä¸šåŠ¡é€»è¾‘**ï¼šä¸šåŠ¡è§„åˆ™å¤æ‚ï¼Œéœ€è¦æ¸…æ™°çš„é¢†åŸŸå»ºæ¨¡
- **å¤§å‹å›¢é˜Ÿ**ï¼šå¤šå›¢é˜Ÿåä½œï¼Œéœ€è¦æ˜ç¡®çš„è¾¹ç•Œå’ŒèŒè´£åˆ’åˆ†
- **é•¿æœŸç»´æŠ¤**ï¼šé¡¹ç›®é¢„æœŸé•¿æœŸè¿­ä»£ï¼Œéœ€è¦è‰¯å¥½çš„æ¶æ„åŸºç¡€
- **é¢†åŸŸä¸“å®¶å‚ä¸**ï¼šæœ‰ä¸šåŠ¡ä¸“å®¶å‚ä¸ï¼Œéœ€è¦ç»Ÿä¸€è¯­è¨€

#### ğŸš€ **ChatWithYoué¡¹ç›®çš„å®é™…æƒ…å†µ**

- **7å¤©å¿«é€Ÿå¼€å‘**ï¼šæ—¶é—´ç´§è¿«ï¼ŒDDDå¯èƒ½è¿‡åº¦è®¾è®¡
- **å•äººå¼€å‘**ï¼šæ— éœ€å¤æ‚çš„å›¢é˜Ÿåä½œæœºåˆ¶
- **ç›¸å¯¹ç®€å•çš„ä¸šåŠ¡**ï¼šä¸»è¦æ˜¯CRUD + AIè°ƒç”¨
- **MVPéªŒè¯**ï¼šä¼˜å…ˆåŠŸèƒ½å®ç°ï¼Œè€Œéå®Œç¾æ¶æ„

#### ğŸ’¡ **æ¨èçš„æ¶æ„æ–¹æ¡ˆ**

**æ–¹æ¡ˆä¸€ï¼šç®€åŒ–çš„åˆ†å±‚æ¶æ„ï¼ˆæ¨èç”¨äº7å¤©å¼€å‘ï¼‰**

```typescript
// ç®€å•ç›´æ¥çš„æ–¹å¼
// composables/useChat.ts
export const useChat = () => {
  const sendMessage = async (message: string, characterId: string) => {
    // ç›´æ¥è°ƒç”¨APIï¼Œç®€å•é«˜æ•ˆ
    const response = await $fetch('/api/chat/send', {
      method: 'POST',
      body: { message, characterId }
    })
    return response
  }
}

// server/api/chat/send.post.ts
export default defineEventHandler(async (event) => {
  const { message, characterId } = await readBody(event)
  
  // è·å–è§’è‰²ä¿¡æ¯
  const character = await getCharacter(characterId)
  
  // æ„å»ºæç¤ºè¯
  const prompt = buildPrompt(character, message)
  
  // è°ƒç”¨AI API
  const aiResponse = await callOpenAI(prompt)
  
  // ä¿å­˜åˆ°æ•°æ®åº“
  await saveMessage({ message, response: aiResponse, characterId })
  
  return { response: aiResponse }
})
```

**æ–¹æ¡ˆäºŒï¼šæœåŠ¡å±‚æ¶æ„ï¼ˆ7å¤©åé‡æ„æ—¶é‡‡ç”¨ï¼‰**

```typescript
// services/characterService.ts
export class CharacterService {
  async getCharacter(id: string): Promise<Character> {
    return await characterRepository.findById(id)
  }
  
  async createCharacter(data: CreateCharacterDto): Promise<Character> {
    const character = new Character(data)
    return await characterRepository.save(character)
  }
}

// services/conversationService.ts
export class ConversationService {
  constructor(
    private characterService: CharacterService,
    private aiService: AIService
  ) {}

  async processMessage(message: string, characterId: string): Promise<string> {
    const character = await this.characterService.getCharacter(characterId)
    const prompt = this.buildPrompt(character, message)
    return await this.aiService.generate(prompt)
  }
}
```

**æ–¹æ¡ˆä¸‰ï¼šå®Œæ•´DDDæ¶æ„ï¼ˆå¤§å‹é¡¹ç›®æˆ–é•¿æœŸç»´æŠ¤ï¼‰**

```typescript
// domain/entities/Character.ts
export class Character {
  constructor(
    private id: CharacterId,
    private profile: CharacterProfile,
    private personality: Personality
  ) {}

  generateSystemPrompt(): SystemPrompt {
    return new SystemPromptBuilder()
      .withProfile(this.profile)
      .withPersonality(this.personality)
      .build()
  }
}

// domain/services/ConversationDomainService.ts
export class ConversationDomainService {
  processUserMessage(
    conversation: Conversation,
    message: string
  ): DomainEvent[] {
    // å¤æ‚çš„ä¸šåŠ¡é€»è¾‘
    // é¢†åŸŸäº‹ä»¶å‘å¸ƒ
    // ä¸šåŠ¡è§„åˆ™éªŒè¯
  }
}
```

### æ¶æ„æ¼”è¿›è·¯å¾„

**ç¬¬ä¸€é˜¶æ®µï¼ˆ1-7å¤©ï¼‰ï¼šå¿«é€Ÿå¼€å‘**

```
composables/ + server/api/ + ç®€å•services/
â”œâ”€â”€ é‡ç‚¹ï¼šåŠŸèƒ½å®ç°
â”œâ”€â”€ æ¶æ„ï¼šç®€å•åˆ†å±‚
â””â”€â”€ ç›®æ ‡ï¼šå¿«é€ŸéªŒè¯MVP
```

**ç¬¬äºŒé˜¶æ®µï¼ˆ1-3ä¸ªæœˆï¼‰ï¼šé‡æ„ä¼˜åŒ–**

```
services/ + repositories/ + æ¸…æ™°åˆ†å±‚
â”œâ”€â”€ é‡ç‚¹ï¼šä»£ç ç»„ç»‡
â”œâ”€â”€ æ¶æ„ï¼šæœåŠ¡å±‚æ¨¡å¼
â””â”€â”€ ç›®æ ‡ï¼šä»£ç å¯ç»´æŠ¤æ€§
```

**ç¬¬ä¸‰é˜¶æ®µï¼ˆ3ä¸ªæœˆ+ï¼‰ï¼šä¼ä¸šçº§æ¶æ„**

```
domain/ + application/ + infrastructure/
â”œâ”€â”€ é‡ç‚¹ï¼šä¸šåŠ¡å»ºæ¨¡
â”œâ”€â”€ æ¶æ„ï¼šå®Œæ•´DDD
â””â”€â”€ ç›®æ ‡ï¼šå¤æ‚ä¸šåŠ¡æ”¯æ’‘
```

### å®é™…å»ºè®®

**å¯¹äºChatWithYoué¡¹ç›®ï¼š**

1. **ç«‹å³å¼€å§‹**ï¼šä½¿ç”¨æ–¹æ¡ˆä¸€ï¼Œä¸“æ³¨åŠŸèƒ½å®ç°
2. **åŠŸèƒ½å®Œæˆå**ï¼šå¦‚æœéœ€è¦æ‰©å±•ï¼Œå†è€ƒè™‘é‡æ„ä¸ºæ–¹æ¡ˆäºŒ
3. **ä¸šåŠ¡å¤æ‚åŒ–å**ï¼šå¦‚æœå‡ºç°å¤æ‚ä¸šåŠ¡è§„åˆ™ï¼Œå†å¼•å…¥DDD

**åˆ¤æ–­æ ‡å‡†ï¼š**

```typescript
// å¦‚æœä½ çš„ä»£ç ä¸»è¦æ˜¯è¿™æ ·çš„ï¼Œä¸éœ€è¦DDD
const user = await getUser(id)
const result = await updateUser(user, data)
return result

// å¦‚æœä½ çš„ä»£ç æ˜¯è¿™æ ·çš„ï¼Œè€ƒè™‘DDD
const user = await userRepository.findById(id)
const account = user.getAccount()
if (account.canUpgrade() && user.hasPermission()) {
  const promotion = account.createPromotion(data)
  user.applyPromotion(promotion)
  await userRepository.save(user)
  domainEvents.publish(new UserPromotedEvent(user))
}
```

### é¢†åŸŸåˆ†æ

åŸºäºChatWithYouçš„æ ¸å¿ƒä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥è¯†åˆ«å‡ºä»¥ä¸‹é¢†åŸŸï¼š

#### æ ¸å¿ƒé¢†åŸŸï¼ˆCore Domainï¼‰

- **å¯¹è¯é¢†åŸŸ (Conversation Domain)** - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œå¤„ç†ç”¨æˆ·ä¸AIè§’è‰²çš„å¯¹è¯äº¤äº’

#### æ”¯æ’‘é¢†åŸŸï¼ˆSupporting Domainï¼‰

- **è§’è‰²ç®¡ç†é¢†åŸŸ (Character Domain)** - ç®¡ç†AIè§’è‰²çš„æ•°æ®å’Œè¡Œä¸º
- **ç”¨æˆ·ç®¡ç†é¢†åŸŸ (User Domain)** - ç”¨æˆ·èº«ä»½å’Œä¼šè¯ç®¡ç†

#### é€šç”¨é¢†åŸŸï¼ˆGeneric Domainï¼‰

- **AIæœåŠ¡é¢†åŸŸ (AI Service Domain)** - ä¸å¤–éƒ¨AI APIçš„é›†æˆ
- **é€šçŸ¥é¢†åŸŸ (Notification Domain)** - å®æ—¶æ¶ˆæ¯æ¨é€

### é™ç•Œä¸Šä¸‹æ–‡ (Bounded Context)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¯¹è¯ä¸Šä¸‹æ–‡      â”‚    â”‚   è§’è‰²ä¸Šä¸‹æ–‡      â”‚    â”‚   ç”¨æˆ·ä¸Šä¸‹æ–‡      â”‚
â”‚ (Conversation)   â”‚    â”‚ (Character)      â”‚    â”‚ (User)           â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ - å¯¹è¯ä¼šè¯       â”‚â—„â”€â”€â–ºâ”‚ - è§’è‰²ç®¡ç†       â”‚    â”‚ - ç”¨æˆ·è®¤è¯       â”‚
â”‚ - æ¶ˆæ¯å¤„ç†       â”‚    â”‚ - è§’è‰²æ‰®æ¼”       â”‚â—„â”€â”€â–ºâ”‚ - ä¼šè¯ç®¡ç†       â”‚
â”‚ - ä¸Šä¸‹æ–‡ç»´æŠ¤     â”‚    â”‚ - æç¤ºè¯ç”Ÿæˆ     â”‚    â”‚ - åå¥½è®¾ç½®       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   AIæœåŠ¡ä¸Šä¸‹æ–‡    â”‚
                    â”‚ (AI Service)     â”‚
                    â”‚                 â”‚
                    â”‚ - APIè°ƒç”¨        â”‚
                    â”‚ - å“åº”å¤„ç†       â”‚
                    â”‚ - é”™è¯¯é‡è¯•       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é¢†åŸŸæ¨¡å‹è®¾è®¡

#### 1. å¯¹è¯é¢†åŸŸ (Conversation Domain)

**èšåˆæ ¹ï¼šConversationï¼ˆå¯¹è¯ä¼šè¯ï¼‰**

```typescript
// å¯¹è¯ä¼šè¯èšåˆæ ¹
class Conversation {
  private conversationId: ConversationId
  private userId: UserId
  private characterId: CharacterId
  private messages: Message[]
  private context: ConversationContext
  private status: ConversationStatus
  private createdAt: Date
  private updatedAt: Date

  // å‘é€æ¶ˆæ¯
  sendMessage(content: string): Message {
    const message = new Message(
      MessageId.generate(),
      this.conversationId,
      MessageType.USER,
      content,
      new Date()
    )
    
    this.messages.push(message)
    this.context.addUserMessage(content)
    this.updatedAt = new Date()
    
    // å‘å¸ƒé¢†åŸŸäº‹ä»¶
    DomainEvents.raise(new MessageSentEvent(message))
    
    return message
  }

  // æ¥æ”¶AIå›å¤
  receiveAIReply(content: string): Message {
    const message = new Message(
      MessageId.generate(),
      this.conversationId,
      MessageType.AI,
      content,
      new Date()
    )
    
    this.messages.push(message)
    this.context.addAIMessage(content)
    this.updatedAt = new Date()
    
    return message
  }

  // è·å–å¯¹è¯ä¸Šä¸‹æ–‡
  getContext(): ConversationContext {
    return this.context
  }
}

// æ¶ˆæ¯å€¼å¯¹è±¡
class Message {
  constructor(
    public readonly id: MessageId,
    public readonly conversationId: ConversationId,
    public readonly type: MessageType,
    public readonly content: string,
    public readonly timestamp: Date
  ) {}
}

// å¯¹è¯ä¸Šä¸‹æ–‡å€¼å¯¹è±¡
class ConversationContext {
  private messageHistory: ContextMessage[]
  private maxContextLength: number = 10

  addUserMessage(content: string): void {
    this.messageHistory.push(new ContextMessage('user', content))
    this.trimContext()
  }

  addAIMessage(content: string): void {
    this.messageHistory.push(new ContextMessage('assistant', content))
    this.trimContext()
  }

  getContextForAI(): ContextMessage[] {
    return this.messageHistory.slice(-this.maxContextLength)
  }

  private trimContext(): void {
    if (this.messageHistory.length > this.maxContextLength) {
      this.messageHistory = this.messageHistory.slice(-this.maxContextLength)
    }
  }
}
```

**é¢†åŸŸæœåŠ¡ï¼šConversationService**

```typescript
class ConversationService {
  constructor(
    private aiService: AIService,
    private characterRepository: ICharacterRepository
  ) {}

  async processUserMessage(
    conversation: Conversation,
    message: string
  ): Promise<string> {
    // 1. æ·»åŠ ç”¨æˆ·æ¶ˆæ¯åˆ°å¯¹è¯
    conversation.sendMessage(message)
    
    // 2. è·å–è§’è‰²ä¿¡æ¯
    const character = await this.characterRepository.findById(
      conversation.characterId
    )
    
    // 3. æ„å»ºAIæç¤ºè¯
    const prompt = this.buildPrompt(character, conversation.getContext())
    
    // 4. è°ƒç”¨AIæœåŠ¡
    const aiResponse = await this.aiService.generateResponse(prompt)
    
    // 5. æ·»åŠ AIå›å¤åˆ°å¯¹è¯
    conversation.receiveAIReply(aiResponse)
    
    return aiResponse
  }

  private buildPrompt(
    character: Character, 
    context: ConversationContext
  ): AIPrompt {
    return new AIPrompt(
      character.getSystemPrompt(),
      context.getContextForAI()
    )
  }
}
```

#### 2. è§’è‰²ç®¡ç†é¢†åŸŸ (Character Domain)

**èšåˆæ ¹ï¼šCharacterï¼ˆè§’è‰²ï¼‰**

```typescript
class Character {
  private characterId: CharacterId
  private profile: CharacterProfile
  private personality: Personality
  private knowledgeBase: KnowledgeBase
  private speakingStyle: SpeakingStyle
  private isActive: boolean

  constructor(
    id: CharacterId,
    profile: CharacterProfile,
    personality: Personality,
    knowledgeBase: KnowledgeBase,
    speakingStyle: SpeakingStyle
  ) {
    this.characterId = id
    this.profile = profile
    this.personality = personality
    this.knowledgeBase = knowledgeBase
    this.speakingStyle = speakingStyle
    this.isActive = true
  }

  // ç”Ÿæˆç³»ç»Ÿæç¤ºè¯
  getSystemPrompt(): string {
    return new SystemPromptBuilder()
      .withProfile(this.profile)
      .withPersonality(this.personality)
      .withKnowledgeBase(this.knowledgeBase)
      .withSpeakingStyle(this.speakingStyle)
      .build()
  }

  // æ›´æ–°è§’è‰²ä¿¡æ¯
  updateProfile(newProfile: CharacterProfile): void {
    this.profile = newProfile
    DomainEvents.raise(new CharacterUpdatedEvent(this.characterId))
  }

  // æ¿€æ´»/åœç”¨è§’è‰²
  activate(): void {
    this.isActive = true
  }

  deactivate(): void {
    this.isActive = false
  }
}

// è§’è‰²æ¡£æ¡ˆå€¼å¯¹è±¡
class CharacterProfile {
  constructor(
    public readonly name: string,
    public readonly background: string,
    public readonly avatar: string,
    public readonly category: CharacterCategory,
    public readonly tags: string[]
  ) {}
}

// æ€§æ ¼ç‰¹å¾å€¼å¯¹è±¡
class Personality {
  constructor(
    public readonly traits: string[],
    public readonly values: string[],
    public readonly motivations: string[]
  ) {}
}

// çŸ¥è¯†åº“å€¼å¯¹è±¡
class KnowledgeBase {
  constructor(
    public readonly expertise: string[],
    public readonly famousQuotes: string[],
    public readonly historicalContext: string,
    public readonly keyEvents: string[]
  ) {}
}

// è¯´è¯é£æ ¼å€¼å¯¹è±¡
class SpeakingStyle {
  constructor(
    public readonly vocabulary: string,
    public readonly tone: string,
    public readonly patterns: string[],
    public readonly examples: string[]
  ) {}
}
```

#### 3. ç”¨æˆ·ç®¡ç†é¢†åŸŸ (User Domain)

**èšåˆæ ¹ï¼šUserï¼ˆç”¨æˆ·ï¼‰**

```typescript
class User {
  private userId: UserId
  private profile: UserProfile
  private preferences: UserPreferences
  private sessions: Session[]
  private createdAt: Date

  constructor(
    id: UserId,
    profile: UserProfile,
    preferences: UserPreferences
  ) {
    this.userId = id
    this.profile = profile
    this.preferences = preferences
    this.sessions = []
    this.createdAt = new Date()
  }

  // åˆ›å»ºæ–°ä¼šè¯
  createSession(): Session {
    const session = new Session(
      SessionId.generate(),
      this.userId,
      new Date()
    )
    this.sessions.push(session)
    return session
  }

  // æ›´æ–°åå¥½è®¾ç½®
  updatePreferences(newPreferences: UserPreferences): void {
    this.preferences = newPreferences
    DomainEvents.raise(new UserPreferencesUpdatedEvent(this.userId))
  }
}

// ç”¨æˆ·åå¥½å€¼å¯¹è±¡
class UserPreferences {
  constructor(
    public readonly favoriteCharacters: CharacterId[],
    public readonly chatSettings: ChatSettings,
    public readonly uiTheme: string
  ) {}
}
```

### ä»“å‚¨æ¥å£å®šä¹‰

```typescript
// å¯¹è¯ä»“å‚¨æ¥å£
interface IConversationRepository {
  save(conversation: Conversation): Promise<void>
  findById(id: ConversationId): Promise<Conversation | null>
  findByUserId(userId: UserId): Promise<Conversation[]>
  findByUserAndCharacter(
    userId: UserId, 
    characterId: CharacterId
  ): Promise<Conversation[]>
}

// è§’è‰²ä»“å‚¨æ¥å£
interface ICharacterRepository {
  save(character: Character): Promise<void>
  findById(id: CharacterId): Promise<Character | null>
  findByCategory(category: CharacterCategory): Promise<Character[]>
  findActive(): Promise<Character[]>
  search(query: string): Promise<Character[]>
}

// ç”¨æˆ·ä»“å‚¨æ¥å£
interface IUserRepository {
  save(user: User): Promise<void>
  findById(id: UserId): Promise<User | null>
  findByEmail(email: string): Promise<User | null>
}
```

### é¢†åŸŸäº‹ä»¶

```typescript
// æ¶ˆæ¯å‘é€äº‹ä»¶
class MessageSentEvent implements IDomainEvent {
  constructor(
    public readonly message: Message,
    public readonly occurredAt: Date = new Date()
  ) {}
}

// è§’è‰²æ›´æ–°äº‹ä»¶
class CharacterUpdatedEvent implements IDomainEvent {
  constructor(
    public readonly characterId: CharacterId,
    public readonly occurredAt: Date = new Date()
  ) {}
}

// å¯¹è¯å¼€å§‹äº‹ä»¶
class ConversationStartedEvent implements IDomainEvent {
  constructor(
    public readonly conversationId: ConversationId,
    public readonly userId: UserId,
    public readonly characterId: CharacterId,
    public readonly occurredAt: Date = new Date()
  ) {}
}
```

### åº”ç”¨æœåŠ¡å±‚

```typescript
// å¯¹è¯åº”ç”¨æœåŠ¡
class ConversationApplicationService {
  constructor(
    private conversationRepository: IConversationRepository,
    private characterRepository: ICharacterRepository,
    private userRepository: IUserRepository,
    private conversationService: ConversationService,
    private eventBus: IEventBus
  ) {}

  async startConversation(
    userId: UserId,
    characterId: CharacterId
  ): Promise<ConversationDto> {
    // éªŒè¯ç”¨æˆ·å’Œè§’è‰²å­˜åœ¨
    const user = await this.userRepository.findById(userId)
    const character = await this.characterRepository.findById(characterId)
    
    if (!user || !character) {
      throw new DomainException('User or Character not found')
    }

    // åˆ›å»ºæ–°å¯¹è¯
    const conversation = new Conversation(
      ConversationId.generate(),
      userId,
      characterId
    )

    // ä¿å­˜å¯¹è¯
    await this.conversationRepository.save(conversation)

    // å‘å¸ƒäº‹ä»¶
    this.eventBus.publish(
      new ConversationStartedEvent(
        conversation.id,
        userId,
        characterId
      )
    )

    return ConversationMapper.toDto(conversation)
  }

  async sendMessage(
    conversationId: ConversationId,
    message: string
  ): Promise<MessageDto> {
    // è·å–å¯¹è¯
    const conversation = await this.conversationRepository.findById(conversationId)
    if (!conversation) {
      throw new DomainException('Conversation not found')
    }

    // å¤„ç†æ¶ˆæ¯
    const aiResponse = await this.conversationService.processUserMessage(
      conversation,
      message
    )

    // ä¿å­˜æ›´æ–°çš„å¯¹è¯
    await this.conversationRepository.save(conversation)

    return {
      content: aiResponse,
      type: 'ai',
      timestamp: new Date()
    }
  }
}
```

### åŸºç¡€è®¾æ–½å±‚å®ç°ç¤ºä¾‹

```typescript
// MongoDB å¯¹è¯ä»“å‚¨å®ç°
class MongoConversationRepository implements IConversationRepository {
  constructor(private db: MongoDatabase) {}

  async save(conversation: Conversation): Promise<void> {
    const doc = ConversationMapper.toPersistence(conversation)
    await this.db.collection('conversations').replaceOne(
      { _id: doc._id },
      doc,
      { upsert: true }
    )
  }

  async findById(id: ConversationId): Promise<Conversation | null> {
    const doc = await this.db.collection('conversations').findOne({
      _id: id.value
    })
    
    return doc ? ConversationMapper.toDomain(doc) : null
  }
}

// OpenAI æœåŠ¡å®ç°
class OpenAIService implements AIService {
  constructor(private openai: OpenAI) {}

  async generateResponse(prompt: AIPrompt): Promise<string> {
    const response = await this.openai.chat.completions.create({
      model: 'gpt-4',
      messages: [
        { role: 'system', content: prompt.systemPrompt },
        ...prompt.context.map(msg => ({
          role: msg.role,
          content: msg.content
        }))
      ],
      temperature: 0.7,
      max_tokens: 500
    })

    return response.choices[0].message.content || ''
  }
}
```

### DDDåˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            è¡¨ç°å±‚ (UI Layer)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Web UI    â”‚ â”‚  Mobile UI  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åº”ç”¨å±‚ (Application)         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚Application  â”‚ â”‚   Command   â”‚    â”‚
â”‚  â”‚   Services  â”‚ â”‚   Handlers  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          é¢†åŸŸå±‚ (Domain)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Entities   â”‚ â”‚   Domain    â”‚    â”‚
â”‚  â”‚   & VOs     â”‚ â”‚   Services  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚Repositories â”‚ â”‚   Events    â”‚    â”‚
â”‚  â”‚(Interfaces) â”‚ â”‚             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       åŸºç¡€è®¾æ–½å±‚ (Infrastructure)     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Database   â”‚ â”‚External APIsâ”‚    â”‚
â”‚  â”‚(MongoDB)    â”‚ â”‚(OpenAI)     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Message   â”‚ â”‚   File      â”‚    â”‚
â”‚  â”‚    Queue    â”‚ â”‚   Storage   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è¿™ä¸ªDDDæ¶æ„è®¾è®¡å°†ChatWithYoué¡¹ç›®çš„å¤æ‚åº¦è¿›è¡Œäº†åˆç†çš„åˆ†è§£ï¼Œæ¯ä¸ªé¢†åŸŸéƒ½æœ‰æ˜ç¡®çš„èŒè´£è¾¹ç•Œï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•ã€‚


