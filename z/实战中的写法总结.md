---
tags:
  - tech/dev/frontend
  - type/howto
  - status/growing
description: å®æˆ˜ä¸­çš„å†™æ³•æ€»ç»“
created: 2025-01-01T00:00:00
updated: 2025-12-07T21:16:36
---

> [!info] **ä¸Šçº§ç´¢å¼•**
> [[é¡¹ç›®å®è·µ MOC]] | [[åç«¯å¼€å‘ MOC]]

---


## æ€»ç»“ç‰ˆ

1. ç»„ä»¶é—´ä¼  idï¼Œè€Œéå®Œæ•´å¯¹è±¡ï¼Œå­ç»„ä»¶é€šè¿‡ store è·å–å¯¹è±¡ï¼Œæå‡æ€§èƒ½ï¼Œç¡®ä¿å“åº”å¼ã€‚

### å¯¹è±¡çš„åˆ›å»ºç¼–è¾‘è¡¨å•

1. ç»™å¯¹è±¡å®ç° cloneï¼ˆå¤åˆ¶ä¸€ä¸ªå¯¹è±¡ï¼‰ å’Œ forCreateï¼ˆåˆ›å»ºä¸€ä¸ªåˆå§‹åŒ–äº†åŸºç¡€ä¿¡æ¯ï¼ˆuuidç­‰ï¼‰çš„å¯¹è±¡ï¼‰ æ–¹æ³•
2. ç»™è¡¨å•ä¼ å…¥ å¯¹è±¡ | nullï¼Œå†é€šè¿‡ watch ç›‘å¬å¯¹è±¡ï¼Œå¦‚æœå¯¹è±¡ä¸º nullï¼Œåˆ™åˆ›å»ºä¸€ä¸ªåˆå§‹å¯¹è±¡ï¼Œå¦åˆ™å°± clone ä¸€ä¸ªå¯¹è±¡ã€‚
3. è¡¨å•ä¸æœ¬åœ°å¯¹è±¡åŒå‘ç»‘å®šï¼Œç¼–è¾‘æˆ–åˆ›å»ºæäº¤æ—¶ä¼ é€’æœ¬åœ°å¯¹è±¡

ä¿®æ”¹å½“å‰ GoalDialog ä½¿ç”¨ç±»ä¼¼ TemplateDialog çš„æ–¹å¼ï¼Œä¼ å…¥ç¼–è¾‘å¯¹è±¡çš„å®ä¾‹ï¼ˆç¼–è¾‘æ¨¡å¼ï¼‰æˆ– nullï¼ˆåˆ›å»ºæ¨¡å¼ï¼‰ï¼Œwatch visible å’Œ ä¼ å…¥çš„å¯¹è±¡ï¼Œä½¿ç”¨å¯¹è±¡çš„ clone æˆ– forCreate æ–¹æ³•åˆå§‹åŒ–æœ¬åœ°å¯¹è±¡ï¼Œè¡¨å•ä¸æœ¬åœ°å¯¹è±¡åŒå‘ç»‘å®šï¼Œç¼–è¾‘æˆ–åˆ›å»ºæäº¤æ—¶ä¼ é€’æœ¬åœ°å¯¹è±¡

### è¦åŒæ­¥å˜åŒ–çš„æŒ‰é’®è¡¨å•

1. ç›´æ¥ä¼ å…¥å¯¹è±¡çš„ uuid
2. ä» store ä¸­è·å–å“åº”å¼å¯¹è±¡

### å¯¹è±¡çš„æ•°æ®ç›¸å…³æ–¹æ³•

- `toDTO()`ï¼š å°†å¯¹è±¡å®ä¾‹è½¬ä¸ºå¯¹è±¡æ¥å£æ•°æ®
- `static fromDTO(dto: T)`ï¼š å°†å¯¹è±¡æ¥å£æ•°æ®è½¬ä¸ºå¯¹è±¡å®ä¾‹
- `clone()`ï¼š åˆ›å»ºå¯¹è±¡çš„å‰¯æœ¬
- `forCreate()`ï¼š åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼Œç”¨äºåˆ›å»ºæ¨¡å¼
- `isxxx()`ï¼š åˆ¤æ–­å¯¹è±¡å®ä¾‹æ˜¯å¦ä¸ºxxxå¯¹è±¡å®ä¾‹
- `ensurexxx()`ï¼š ç¡®ä¿å¯¹è±¡å®ä¾‹ä¸ºxxxå¯¹è±¡å®ä¾‹
- `ensurexxxNeverNull()`ï¼š ç¡®ä¿å¯¹è±¡å®ä¾‹ä¸ºxxxå¯¹è±¡å®ä¾‹ï¼Œå¹¶ä¸”ä¸ä¸ºnull

å¯¹è±¡å±æ€§æœ‰äº›æ˜¯åˆ›å»ºæ˜¯ä¼ å…¥çš„ï¼Œæœ‰äº›æ˜¯å¯¹è±¡å†…éƒ¨åˆå§‹åŒ–çš„æ¯”å¦‚ç”Ÿå‘½å‘¨æœŸç­‰ï¼ˆä¸èƒ½åœ¨åˆ›å»ºæ—¶ä¼ å…¥ï¼Œuuid åœ¨forCreateä¸­ä¸éœ€è¦ä¼ å…¥ï¼‰ï¼Œæ‰€ä»¥ `cloneï¼ˆï¼‰` ç­‰ä»å·²æœ‰å¯¹è±¡åˆ›å»ºå¯¹è±¡å®ä¾‹æ—¶ï¼Œéœ€è¦é€šè¿‡constructor åˆ›å»ºå®ä¾‹åå†åˆ©ç”¨ setter æ–¹æ³•è®¾ç½®å†…éƒ¨å±æ€§ã€‚

### ç±»å‹æ–­å®šç›¸å…³è¯­æ³•ç³–å†™æ³•æ•´ç†

#### 1. å¯é€‰é“¾ï¼ˆOptional Chainingï¼‰`?.`

ç”¨äºå®‰å…¨åœ°è®¿é—®å¯¹è±¡çš„åµŒå¥—å±æ€§æˆ–æ–¹æ³•ï¼Œé¿å…å› ä¸­é—´å±æ€§ä¸º null/undefined è€ŒæŠ¥é”™ã€‚

```ts
const arr = systemGroup?.templates;
```
ç­‰ä»·äºï¼š
```ts
const arr = systemGroup ? systemGroup.templates : undefined;
```

#### 2. ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦ï¼ˆNullish Coalescingï¼‰`??`

ç”¨äºä¸º null æˆ– undefined çš„å€¼æä¾›é»˜è®¤å€¼ã€‚

```ts
const arr = systemGroup?.templates ?? [];
```
ç­‰ä»·äºï¼š
```ts
const arr = (systemGroup && systemGroup.templates) != null ? systemGroup.templates : [];
```

#### 3. éç©ºè¿ç®—ç¬¦ï¼ˆNon-null Assertionï¼‰`!`

ç”¨äºå‘Šè¯‰ TypeScript å¿½ç•¥ null æˆ– undefined çš„å€¼ã€‚

#### 3. å±•å¼€è¿ç®—ç¬¦ï¼ˆSpread Operatorï¼‰`...`

ç”¨äºæ•°ç»„æˆ–å¯¹è±¡çš„å±•å¼€ã€åˆå¹¶ã€‚

```ts
const allTemplates = [...(systemGroup?.templates ?? []), ...otherTemplates];
```

---

### å‡½æ•°çš„å‚æ•°

å‡½æ•°çš„å‚æ•°åº”è¯¥é‡‡ç”¨å¯¹è±¡å½¢å¼ï¼š  
- ä¸éœ€è¦è®°ä½å‚æ•°é¡ºåºï¼Œè°ƒç”¨æ—¶åªéœ€å†™æ˜å±æ€§åã€‚
- å¯é€‰å‚æ•°å¯ä»¥çœç•¥ï¼Œä¸ä¼šå› é¡ºåºé”™ä¹±å¯¼è‡´ bugã€‚
- ä»£ç æ›´æ˜“è¯»ã€æ˜“ç»´æŠ¤ï¼Œæ‰©å±•æ€§æ›´å¥½ã€‚

### ä¿®æ”¹å¯¹è±¡çš„è¡¨å•

ç»™è¡¨å•ä¼ å…¥ è¦ä¿®æ”¹çš„å¯¹è±¡ï¼ˆç¼–è¾‘ï¼‰ || nullï¼ˆåˆ›å»ºï¼‰ï¼Œç›´æ¥ä½¿ç”¨ forCreateï¼ˆç¼–è¾‘ï¼‰ æˆ–è€… cloneï¼ˆåˆ›å»ºï¼‰ æ–¹æ³•æ¥ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åè®©è¡¨å•ä¸è¿™ä¸ªå¯¹è±¡åŒå‘ç»‘å®šæ¥ä¿®æ”¹æˆ–åˆ›å»ºï¼ˆæ¯ä¸€ä¸ªå±æ€§åˆ©ç”¨ computed çš„ get set æ–¹æ³•æ¥å¤„ç†ï¼‰ï¼ŒæˆåŠŸåè°ƒç”¨ç›¸åº”æœåŠ¡å’Œä¼ å…¥å¯¹è±¡ã€‚

### Electron çš„è¿›ç¨‹é—´æ•°æ®ä¼ è¾“é‡åˆ°é—®é¢˜ï¼ˆæ— æ³•è¢«å…‹éš†ï¼‰

```
[AccountIpcClient] å‘é€è´¦å·æ³¨å†Œè¯·æ±‚ Proxy(Object)Â {username: '123', firstName: '12', lastName: '3', sex: 1}
accountIpcClient.ts:9 ğŸ“ [AccountIpcClient] åºåˆ—åŒ–åçš„æ³¨å†Œæ•°æ® {username: '123', firstName: '12', lastName: '3', sex: 1}
```
æ³¨æ„ vue ä¸­çš„å¯¹è±¡æ•°æ®å¾ˆæœ‰å¯èƒ½æ˜¯è¢« ä»£ç† çš„ï¼Œéœ€è¦è½¬ä¸ºæ™®é€šå¯¹è±¡ï¼ˆå¯ä»¥ä½¿ç”¨ JSON æ–¹æ³•ï¼‰  

### Ts åœ¨ç±»ä¸­ä½¿ç”¨ pinia çŠ¶æ€çš„å»¶è¿ŸåŠ è½½

ä½¿ç”¨ get æ–¹æ³•å»¶è¿Ÿè·å– pinia çŠ¶æ€ï¼Œå¦åˆ™ä¼šæŠ¥æœªåœ¨ pinia åˆå§‹åŒ–å‰å°±è®¿é—® pinia çŠ¶æ€çš„é”™ã€‚  
ts æ˜¯ç¼–è¯‘æ—¶çš„ï¼Œæ‰€ä»¥æ— æ³•åœ¨è¿è¡Œæ—¶æ£€æŸ¥ pinia çŠ¶æ€çš„è®¿é—®ã€‚  

```ts

private get store() {
  return useReminderStore();
}

```

### ç±»çš„æ‡’åŠ è½½

å»¶è¿Ÿè·å–ä¾èµ–ï¼Œé¿å…å› ä¸ºé™æ€ç¼–è¯‘æ—¶åŠ è½½æœªå‡†å¤‡å¥½çš„ä¾èµ–ã€‚

```ts
class p {
  private _goalStore: ReturnType<typeof useGoalStore> | null = null;

  /**
   * å»¶è¿Ÿè·å– goalStoreï¼Œç¡®ä¿ Pinia å·²ç»åˆå§‹åŒ–
   */
  private get goalStore() {
    if (!this._goalStore) {
      this._goalStore = useGoalStore();
    }
    return this._goalStore;
  }

  async addGoal(goal: IGoal): Promise<void> {
    try {
      await this.goalStore.addGoal(goal);
      console.log(`âœ… [StateRepo] æ·»åŠ ç›®æ ‡åˆ°çŠ¶æ€: ${goal.id}`);
    } catch (error) {
      console.error(`âŒ [StateRepo] æ·»åŠ ç›®æ ‡å¤±è´¥: ${goal.id}`, error);
      throw error;
    }
  }

  isAvailable(): boolean {
    try {
      // ç®€å•æ£€æŸ¥ store æ˜¯å¦å¯ç”¨
      return this.goalStore !== null && this.goalStore !== undefined;
    } catch (error) {
      console.error("âŒ [StateRepo] çŠ¶æ€ä»“åº“ä¸å¯ç”¨", error);
      return false;
    }
  }
}
```

### ç±»çš„å·¥å‚å‡½æ•°åˆ›å»ºå®ä¾‹(å¼‚æ­¥)+å•ä¾‹+ä¾èµ–æ³¨å…¥ï¼ˆåˆ‡æ¢ä¸åŒçš„åˆ›å»ºå·¥å‚ï¼‰

```ts
class AuthenticationLogoutService {
  private static instance: AuthenticationLogoutService;
  private authCredentialRepository: IAuthCredentialRepository;
  constructor(authCredentialRepository: IAuthCredentialRepository) {
    
    this.authCredentialRepository = authCredentialRepository;
  }
  static async createInstance(): Promise<AuthenticationLogoutService> {
    const authenticationContainer = await AuthenticationContainer.getInstance();
    const authCredentialRepository = authenticationContainer.getAuthCredentialRepository();
    return new AuthenticationLogoutService(authCredentialRepository);
  }
  static async getInstance(): Promise<AuthenticationLogoutService> {
    if (!AuthenticationLogoutService.instance) {
      AuthenticationLogoutService.instance = await this.createInstance();
    }
    return AuthenticationLogoutService.instance;
  }

  // ä½ çš„ logout æ–¹æ³•ç­‰...
}


const logoutService = await AuthenticationLogoutService.createInstance();
```

### é¢†åŸŸæœåŠ¡ç±»

é¢†åŸŸæœåŠ¡ç±»ï¼Œç”¨äºå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œå°è£…äº†é¢†åŸŸæ¨¡å‹ï¼Œå¹¶å®šä¹‰äº†é¢†åŸŸæ¨¡å‹ä¹‹é—´çš„å…³ç³»ã€‚  
é¢†åŸŸæœåŠ¡ç±»ä¸ç›´æ¥å¯¼å…¥åŸºç¡€è®¾æ–½å±‚ï¼ˆä»“åº“ï¼‰ï¼Œåº”è¯¥é€šè¿‡åº”ç”¨æœåŠ¡å±‚æ³¨å…¥ä»“åº“ã€‚  

```typescript

```



### å¯¹è±¡å±æ€§çš„è¡¨å•

Vue çš„å“åº”å¼ç³»ç»Ÿå¯¹ class å®ä¾‹çš„ getter/setter æ”¯æŒæœ‰é™ï¼Œç›´æ¥ç”¨ class å®ä¾‹å±æ€§åš v-modelï¼Œåªæœ‰åœ¨ class å†…éƒ¨ç”¨ reactive/ref åŒ…è£¹ï¼Œæˆ–è€…ç”¨ computed åŒ…è£…ï¼Œæ‰èƒ½ä¿è¯è§†å›¾å’Œæ•°æ®åŒæ­¥ã€‚ 

```ts
const enableMode = computed({
  get: () => props.templateGroup?.enableMode || 'group',
  set: (val) => {
    if (localTemplateGroup.value) {
      localTemplateGroup.value.enableMode = val;
    }
  }
});
```

### å¯¹è±¡ç±»å‹å˜åŒ–

TS ä¸­çš„å¯¹è±¡è²Œä¼¼ç±»å‹ä¼šè«åå…¶å¦™çš„å˜åŒ–ï¼Œå¯¼è‡´æŠ¥ç±»å‹çš„åŒ¹é…çš„é”™è¯¯ï¼Œéœ€è¦ä½¿ç”¨ ensure å‡½æ•°æ¥ç¡®ä¿ç±»å‹

```ts

<!-- TemplateDialog -->
      <template-dialog
        :model-value="templateDialog.show"
        :template="templateDialog.template" // è¿™é‡Œä¼šæŠ¥é”™ï¼Œè¦æ”¹ä¸ºä¸‹é¢çš„å‚æ•°
        // ReminderTemplate.ensureReminderTemplate(templateDialog.template)
        @update:modelValue="templateDialog.show = $event"
        @submit="handleTemplateDialogSubmit"
        @create-template="handleCreateReminderTemplate"
        @update-template="handleUpdateReminderTemplate"
      />

const templateDialog = ref({
  show: false,
  template: null as ReminderTemplate | null
});

```

### ç±»å‹å®šä¹‰

åç«¯ä¸­ä¸€èˆ¬å¯¹äºå­˜åœ¨çš„ä½†æ²¡æœ‰å€¼çš„å­—æ®µéƒ½æ˜¯å­˜ null å€¼ï¼Œè¿”å›çš„ä¹Ÿæ˜¯ null å€¼ï¼Œ  
å¯¹æ­¤ï¼Œåœ¨ ts ä¸­çš„ç±»å‹å®šä¹‰ä¸­ï¼Œæ˜¯ç»™è¿™ç±»å­—æ®µå®šä¹‰ä¸º `?` å¯é€‰å­—æ®µå—ï¼Ÿï¼Œä¸è¿‡å¯é€‰å­—æ®µä¸æ˜¯å’Œ undefined ç›¸å…³çš„å—ï¼Œä¸€ä¸ªéå¯é€‰å­—æ®µçš„å€¼ä¸º null ä¼šæŠ¥é”™å—
 
### Vue ç»„ä»¶ä¸­çš„æ–¹æ³•æ¨¡å¼

æ˜¯ç›´æ¥åœ¨å­ç»„ä»¶ä¸­è°ƒç”¨ä¸šåŠ¡æ–¹æ³•
è¿˜æ˜¯å­ç»„ä»¶ä¼ é€’äº‹ä»¶å’Œæ•°æ®åˆ°çˆ¶ç»„ä»¶ï¼Œè®©çˆ¶ç»„ä»¶è°ƒç”¨æ–¹æ³•

æ¨èï¼š**å­ç»„ä»¶ä¼ é€’äº‹ä»¶ï¼Œçˆ¶ç»„ä»¶è°ƒç”¨ä¸šåŠ¡æ–¹æ³•**
- ä¿æŒç»„ä»¶èŒè´£å•ä¸€ï¼Œå­ç»„ä»¶ä¸“æ³¨UIå±•ç¤º
- çˆ¶ç»„ä»¶ç»Ÿä¸€ç®¡ç†ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®æµ
- ä¾¿äºæµ‹è¯•å’Œç»´æŠ¤ï¼Œé™ä½ç»„ä»¶é—´è€¦åˆ

### æ•°æ®åŒæ­¥é—®é¢˜æ’æŸ¥

å½“APIè¿”å›æ•°æ®ä½†ç•Œé¢æ²¡æœ‰æ›´æ–°æ—¶ï¼Œå¯èƒ½çš„é—®é¢˜ï¼š
1. **æ•°æ®è½¬æ¢é—®é¢˜**ï¼šAPIæ•°æ®æ ¼å¼ä¸å‰ç«¯æœŸæœ›ä¸åŒ¹é…
2. **Storeæ›´æ–°é—®é¢˜**ï¼šæ•°æ®è™½ç„¶è·å–ä½†æœªæ­£ç¡®æ›´æ–°åˆ°Pinia store
3. **å“åº”å¼ä¸¢å¤±**ï¼šæ•°æ®æ›´æ–°äº†ä½†ç»„ä»¶æœªç›‘å¬åˆ°å˜åŒ–
4. **ç»„ä»¶æ¸²æŸ“é—®é¢˜**ï¼šä½¿ç”¨äº†é”™è¯¯çš„æ•°æ®æºï¼ˆå¦‚ç¡¬ç¼–ç æ•°æ®ï¼‰

æ’æŸ¥æ­¥éª¤ï¼š
```ts
// 1. æ£€æŸ¥APIæ•°æ®æ˜¯å¦æ­£ç¡®è½¬æ¢
console.log('API response:', response.data);

// 2. æ£€æŸ¥Storeæ˜¯å¦æ›´æ–°
console.log('Store state after update:', store.goalDirs);

// 3. æ£€æŸ¥ç»„ä»¶æ˜¯å¦ä½¿ç”¨æ­£ç¡®çš„æ•°æ®æº
console.log('Component computed data:', computedGoalDirs.value);
```
### ä¸‹è½½é“¾æ¥åˆ›å»º

æµè§ˆå™¨çš„ download å±æ€§ä»…åœ¨åŒæºèµ„æºæˆ–ä½¿ç”¨ blob: URL æ—¶å¯é ã€‚å¯¹äºè·¨åŸŸæˆ–æœåŠ¡å™¨è¿”å›å¯ inline æ‰“å¼€çš„èµ„æºï¼ˆå¦‚ç›´æ¥è®¿é—®çš„è§†é¢‘/PDFï¼‰ï¼Œæµè§ˆå™¨é€šå¸¸ä¼šåœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€è€Œä¸æ˜¯ä¸‹è½½ã€‚
è§£å†³åŠæ³•ï¼šå…ˆä»¥äºŒè¿›åˆ¶ï¼ˆblobï¼‰æ–¹å¼ä¸‹è½½æ–‡ä»¶ï¼ˆéœ€åç«¯å…è®¸ CORSï¼‰ï¼Œç”¨ URL.createObjectURL ç”Ÿæˆ blob: åœ°å€å¹¶è§¦å‘ä¸‹è½½ï¼›è‹¥è¯·æ±‚å¤±è´¥å†å›é€€åˆ°ç›´æ¥æ‰“å¼€é“¾æ¥ã€‚

```ts
async function downloadSingleFile(file: any) {
  if (!file || !file.fileUrl) return;
  const filename = file.fileName || 'download';
  const sourceUrl = formatImgUrl(file.fileUrl);

  try {
    const resp = await axios.get(sourceUrl, { responseType: 'blob' });
    const blob = new Blob([resp.data], { type: resp.data.type || 'application/octet-stream' });
    const blobUrl = window.URL.createObjectURL(blob);

    const link = document.createElement('a');
    link.href = blobUrl;
    link.download = filename;
    // ä¸è®¾ç½® targetï¼Œé¿å…æµè§ˆå™¨åœ¨æ–°æ ‡ç­¾æ‰“å¼€ï¼ˆdownload ä¼šè§¦å‘ä¿å­˜ï¼‰
    document.body.appendChild(link);
    link.click();

    // æ¸…ç†
    setTimeout(() => {
      document.body.removeChild(link);
      window.URL.revokeObjectURL(blobUrl);
    }, 1000);
  } catch (err) {
    // å¦‚æœå› ä¸º CORS æˆ–å…¶ä»–åŸå› ä¸èƒ½ä»¥ blob æ–¹å¼è·å–ï¼Œåˆ™å›é€€åˆ°åœ¨æ–°æ ‡ç­¾æ‰“å¼€ï¼ˆç”¨æˆ·å¯æ‰‹åŠ¨å¦å­˜ï¼‰
    window.open(sourceUrl, '_blank');
  }
}
```

## DDD å®è·µç›¸å…³

### é¢†åŸŸæœåŠ¡ å’Œ åº”ç”¨å±‚æœåŠ¡

ä»¥ Goal é¢†åŸŸä¸ºä¾‹ï¼Œæœ‰ èšåˆæ ¹ Goalï¼Œå®ä½“ GoalRecordã€GoalReviewã€Keyresultã€‚

é¢†åŸŸæœåŠ¡ä¸­åº”è¯¥æœ‰ä»€ä¹ˆï¼Œæˆ‘ç›®å‰çš„ç†è§£æ˜¯ æŠŠ Goal é¢†åŸŸå†…çš„ä¸€äº›ä¸šåŠ¡é€»è¾‘æ”¾åœ¨é¢†åŸŸæœåŠ¡ä¸­ï¼Œæ¯”å¦‚ addGoalRecordï¼ˆåœ¨Goal ä¸­æ·»åŠ  Recordï¼‰ï¼Œ
ç„¶å goal å®ä½“ä¸­çš„ addGoalRecord æ¥è°ƒç”¨è¿™ä¸ªé¢†åŸŸæœåŠ¡ã€‚

åº”ç”¨å±‚æœåŠ¡åˆ™æ˜¯ è·¨é¢†åŸŸçš„ä¸€äº› åº”ç”¨å±‚é¢çš„æœåŠ¡ï¼Œ

æˆ‘çš„ç†è§£å¯¹å—ï¼Œæ­£ç¡®çš„åº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„

ğŸ“‹ æ­£ç¡®çš„DDDèŒè´£åˆ’åˆ†æ€»ç»“
1. èšåˆæ ¹ (Goal) - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
âœ… æ‹¥æœ‰ä¸šåŠ¡æ–¹æ³•: createRecord(), updateRecord(), removeRecord()
âœ… å°è£…ä¸šåŠ¡è§„åˆ™: æ•°æ®éªŒè¯ã€çŠ¶æ€ç®¡ç†ã€ä¸å˜æ€§ç»´æŠ¤
âœ… ç®¡ç†å­å®ä½“: æ§åˆ¶ KeyResultã€GoalRecordã€GoalReview çš„ç”Ÿå‘½å‘¨æœŸ
âœ… å‘å¸ƒé¢†åŸŸäº‹ä»¶: é€šçŸ¥å…¶ä»–æ¨¡å—é‡è¦ä¸šåŠ¡å˜æ›´
âœ… è‡ªåŒ…å«é€»è¾‘: å•ä¸ªèšåˆå†…çš„æ‰€æœ‰ä¸šåŠ¡é€»è¾‘
2. é¢†åŸŸæœåŠ¡ (GoalDomainService) - è·¨èšåˆä¸šåŠ¡é€»è¾‘
âœ… è·¨èšåˆåè°ƒ: å¤„ç†å¤šä¸ª Goal ä¹‹é—´çš„å…³ç³»
âœ… å¤æ‚ç®—æ³•: ç›®æ ‡å¥åº·åº¦è®¡ç®—ã€æƒé‡åˆ†é…ç®—æ³•
âœ… ä¸šåŠ¡ç­–ç•¥: ç›®æ ‡å†²çªæ£€æµ‹ã€å…‹éš†ç­–ç•¥
âœ… æ— çŠ¶æ€æœåŠ¡: ä¸æŒæœ‰æ•°æ®ï¼Œåªæœ‰çº¯ä¸šåŠ¡é€»è¾‘
âŒ ä¸åšæŒä¹…åŒ–: ä¸ç›´æ¥è°ƒç”¨ä»“å‚¨æˆ–API
3. åº”ç”¨æœåŠ¡ (GoalWebApplicationService) - ç”¨ä¾‹åè°ƒ
âœ… ç”¨ä¾‹ç¼–æ’: åè°ƒå®Œæ•´çš„ä¸šåŠ¡æµç¨‹
âœ… è·¨é¢†åŸŸåè°ƒ: è°ƒç”¨å¤šä¸ªé¢†åŸŸçš„æœåŠ¡
âœ… æŠ€æœ¯å…³æ³¨ç‚¹: APIè°ƒç”¨ã€ç¼“å­˜ç®¡ç†ã€é”™è¯¯å¤„ç†
âœ… äº‹åŠ¡ç®¡ç†: ç¡®ä¿æ•°æ®ä¸€è‡´æ€§
âœ… åŸºç¡€è®¾æ–½é›†æˆ: æŒä¹…åŒ–ã€é€šçŸ¥ã€æ—¥å¿—ç­‰

### contracts

äº‹ä»¶æ€»çº¿ä¸­çš„å„ç§äº‹ä»¶ç±»å‹çš„ç®¡ç†ï¼Œå¦‚æœåœ¨å„ä¸ªæ¨¡å—ä¸­ç›´æ¥å®šä¹‰æŸä¸ªäº‹ä»¶ç±»å‹ï¼Œå…¶ä»–æ¨¡å—å¯¼å…¥äº†æ­¤äº‹ä»¶ç±»å‹ï¼Œæ­¤æ—¶è€¦åˆäº†ã€‚  

æ¨¡å—åªä¾èµ–å…±äº«å¥‘çº¦ï¼Œä¸ä¾èµ–å…¶ä»–ä¸šåŠ¡æ¨¡å—ï¼ˆå°±åªæ˜¯æŠŠäº‹ä»¶ç±»å‹å®šä¹‰æ”¾åœ¨å…±äº«æ–‡ä»¶å¤¹ä¸­äº†å§ï¼‰  

### èšåˆæ ¹å†…ä¸šåŠ¡

åœ¨ æœåŠ¡æ–¹æ³•ä¸­å…ˆè·å–å¯¹è±¡ï¼Œå‚æ•°ç­‰ï¼Œå¹¶ç¡®ä¿æ­£å¸¸ï¼Œå†…éƒ¨æ–¹æ³•åˆ™åˆ©ç”¨éªŒè¯çš„æ•°æ®æ¥æ“ä½œï¼Œç¡®ä¿å†…éƒ¨ä¸ä¼šå‘ç”Ÿé”™è¯¯  

```ts
/**
  * æ·»åŠ è®°å½•
  */
addRecord(record: Record): void {
  const { keyResultUuid } = record;
  const keyResult = this._keyResults.find((kr) => kr.uuid === keyResultUuid);
  if (keyResult) {
    this.increaseKeyResultProgressByKR(keyResult, record.value);
    this._records.push(record);
    this._lifecycle.updatedAt = new Date();
    this._version++;
  }
}
```

### ä»“åº“å®ç°

å®ç° mapRowToKeyResultï¼ˆæ•°æ®åº“æ•°æ®è½¬æ¢æˆå¯¹è±¡ï¼‰å’Œ mapKeyResultToRowï¼ˆå¯¹è±¡è½¬æ¢æˆæ•°æ®åº“æ•°æ®ï¼‰

{
    "uuid": "3271617c-4f41-4a73-96c9-535081ba091d",
    "goalUuid": "05bd7999-f0fe-4746-a263-f3eab8d41e47",
    "title": "",
    "type": "custom",
    "reviewDate": "2025-07-27T15:01:44.646Z",
    "content": {
        "achievements": "2",
        "challenges": "",
        "learnings": "",
        "nextSteps": "3"
    },
    "snapshot": {
        "snapshotDate": "2025-07-27T15:01:44.646Z",
        "overallProgress": 0,
        "weightedProgress": 0,
        "completedKeyResults": 0,
        "totalKeyResults": 0,
        "keyResultsSnapshot": [
            {
                "uuid": "ca8fee17-6fe3-4dc8-b799-7ed8d70fb10e",
                "name": "22222",
                "progress": 0,
                "currentValue": 0,
                "targetValue": 10
            }
        ]
    },
    "rating": {
        "progressSatisfaction": 0,
        "executionEfficiency": 0,
        "goalReasonableness": 0
    },
    "lifecycle": {
        "createdAt": "2025-07-27T15:01:44.647Z",
        "updatedAt": "2025-07-27T15:01:44.647Z"
    }
}

### äº‹ä»¶æ€»çº¿

å‘å¸ƒã€è®¢é˜…ã€è½¬å‘


äº‹ä»¶æ€»çº¿ç³»ç»Ÿæ˜¯ä¸€ä¸ªç›‘å¬ï¼Œä¸€ä¸ªå‘é€äº‹ä»¶ï¼Œæ€»çº¿æ¥è½¬å‘ï¼›  
auth æ¨¡å— ç™»å½•æ—¶å‘ account æ¨¡å— å‘é€è¯·æ±‚è·å–å®Œæ•´ account ä¿¡æ¯ï¼›  
accountæ¨¡å— å†å‘ auth æ¨¡å—å‘é€è¯·æ±‚æ¥è¿”å›å®Œæ•´ä¿¡æ¯ã€‚

è¿™æ ·æ˜¯ç±»ä¼¼ electron ä¸­çš„ send å’Œ onï¼Œå•å‘çš„ã€‚  

æˆ‘æ˜¯ä¸æ˜¯å¯ä»¥å®ç°ï¼š  
auth æ¨¡å— å‘é€è¯·æ±‚ï¼ŒåŒæ—¶ç›‘å¬è¿”å›çš„å“åº”ï¼›  
account æ¨¡å— æ¥æ”¶åˆ°è¯·æ±‚åï¼Œç›´æ¥è¿”å›å“åº”ï¼›  
ç±»ä¼¼ electron ä¸­çš„ invoke å’Œ handle

ç›´æ¥ä½¿ç”¨ nodejs å†…ç½®çš„ eventEmitter æˆ–è€… mitt

æˆ‘å¦‚æœç”¨ nodejs å†…ç½®çš„ eventEmitter å®ç°äº‹ä»¶ç±»å¹¶è®© eventBus ç»§æ‰¿çš„è¯ï¼Œæ˜¯ä¸æ˜¯ä¼šè®© å‰ç«¯ clientçš„ domain ä¹Ÿå¼•å…¥ nodejs çš„æ¨¡å—å¯¼è‡´æŠ¥é”™ï¼Ÿ
æˆ‘æ˜¯ä¸æ˜¯åº”è¯¥ä½¿ç”¨ mitt è¿™ç§å¹¿æ³›æ”¯æŒçš„æˆ–è€…æœ‰ä»€ä¹ˆå…¶ä»–æ–¹æ³•

è¿˜å¾—ç”¨ mitt

## pwsh å‘½ä»¤

`pnpm tsc --noEmit 2>&1 | Select-Object -First 50` æ£€æŸ¥è¯­æ³•
